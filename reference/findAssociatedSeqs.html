<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="
    Given multiple samples of bulk Adaptive Immune Receptor Repertoire Sequencing (AIRR-Seq) data and a sample-level or subject-level binary variable of interest such as a disease condition, treatment or clinical outcome, identify receptor sequences that exhibit a statistically significant difference in frequency between the two levels of the binary variable using Fisher's exact test.
findAssociatedSeqs is designed for use when each sample is contained in a separate data frame, with each data frame stored in a separate file. findAssociatedSeqs2 is designed for use with a single data frame containing all samples."><title>
    Identify Receptor Sequences Associated With a Binary Variable — findAssociatedSeqs • NAIR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="
    Identify Receptor Sequences Associated With a Binary Variable — findAssociatedSeqs"><meta property="og:description" content="
    Given multiple samples of bulk Adaptive Immune Receptor Repertoire Sequencing (AIRR-Seq) data and a sample-level or subject-level binary variable of interest such as a disease condition, treatment or clinical outcome, identify receptor sequences that exhibit a statistically significant difference in frequency between the two levels of the binary variable using Fisher's exact test.
findAssociatedSeqs is designed for use when each sample is contained in a separate data frame, with each data frame stored in a separate file. findAssociatedSeqs2 is designed for use with a single data frame containing all samples."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">NAIR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.9041</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/NAIR.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/associated_clusters.html">Searching for Associated TCR/BCR Clusters</a>
    <a class="dropdown-item" href="../articles/buildRepSeqNetwork.html">buildRepSeqNetwork</a>
    <a class="dropdown-item" href="../articles/dual_chain.html">Dual-Chain Network Analysis</a>
    <a class="dropdown-item" href="../articles/network_visualization.html">Network Visualization</a>
    <a class="dropdown-item" href="../articles/public_clusters.html">Searching for Public TCR/BCR Clusters</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1><!-- %%  ~~function to do ... ~~ -->
    Identify Receptor Sequences Associated With a Binary Variable</h1>
      
      <div class="d-none name"><code>findAssociatedSeqs.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><!-- %%  ~~ A concise (1-5 lines) description of what the function does. ~~ -->
    Given multiple samples of bulk Adaptive Immune Receptor Repertoire Sequencing (AIRR-Seq) data and a sample-level or subject-level binary variable of interest such as a disease condition, treatment or clinical outcome, identify receptor sequences that exhibit a statistically significant difference in frequency between the two levels of the binary variable using Fisher's exact test.</p>
<p><code>findAssociatedSeqs</code> is designed for use when each sample is contained in a separate data frame, with each data frame stored in a separate file. <code>findAssociatedSeqs2</code> is designed for use with a single data frame containing all samples.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">findAssociatedSeqs</span><span class="op">(</span></span>
<span>  <span class="co">## Input ##</span></span>
<span>  <span class="va">file_list</span>,</span>
<span>  <span class="va">input_type</span>,</span>
<span>  data_symbols <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  header <span class="op">=</span> <span class="cn">TRUE</span>, sep <span class="op">=</span> <span class="st">""</span>,</span>
<span>  sample_ids <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  subject_ids <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">group_ids</span>,</span>
<span>  groups <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">seq_col</span>,</span>
<span>  freq_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span></span>
<span>  <span class="co">## Search Criteria ##</span></span>
<span>  min_seq_length <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  drop_matches <span class="op">=</span> <span class="st">"[*|_]"</span>,</span>
<span>  min_sample_membership <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  pval_cutoff <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span></span>
<span>  <span class="co">## Output ##</span></span>
<span>  outfile <span class="op">=</span> <span class="st">"associated_seqs.csv"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu">findAssociatedSeqs2</span><span class="op">(</span></span>
<span>  <span class="co">## Input ##</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">seq_col</span>,</span>
<span>  <span class="va">sample_col</span>,</span>
<span>  subject_col <span class="op">=</span> <span class="va">sample_col</span>,</span>
<span>  <span class="va">group_col</span>,</span>
<span>  groups <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  freq_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span></span>
<span>  <span class="co">## Search Criteria ##</span></span>
<span>  min_seq_length <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  drop_matches <span class="op">=</span> <span class="st">"[*|_]"</span>,</span>
<span>  min_sample_membership <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  pval_cutoff <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span></span>
<span>  <span class="co">## Ouptut ##</span></span>
<span>  outfile <span class="op">=</span> <span class="st">"associated_seqs.csv"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>file_list</dt>
<dd><p><!-- %%     ~~Describe \code{file_list} here~~ -->
  Passed to <code><a href="combineSamples.html">loadDataFromFileList</a></code> (one data frame per sample).</p></dd>

  <dt>input_type</dt>
<dd><p><!-- %%     ~~Describe \code{input_type} here~~ -->
  Passed to <code><a href="combineSamples.html">loadDataFromFileList</a></code>.</p></dd>

  <dt>data_symbols</dt>
<dd><p><!-- %%     ~~Describe \code{data_symbols} here~~ -->
  Passed to <code><a href="combineSamples.html">loadDataFromFileList</a></code>.</p></dd>

  <dt>header</dt>
<dd><p><!-- %%     ~~Describe \code{header} here~~ -->
  Passed to <code><a href="combineSamples.html">loadDataFromFileList</a></code>.</p></dd>

  <dt>sep</dt>
<dd><p><!-- %%     ~~Describe \code{sep} here~~ -->
  Passed to <code><a href="combineSamples.html">loadDataFromFileList</a></code>.</p></dd>

  <dt>sample_ids</dt>
<dd><p><!-- %%     ~~Describe \code{sample_ids} here~~ -->
  Deprecated. Does nothing.</p></dd>

  <dt>subject_ids</dt>
<dd><p><!-- %%     ~~Describe \code{subject_ids} here~~ -->
  A character or numeric vector of subject IDs, whose length matches that of <code>file_list</code>.
  Only relevant when the binary variable of interest is subject-specific and multiple samples belong to the same subject.</p></dd>

  <dt>group_ids</dt>
<dd><p><!-- %%     ~~Describe \code{group_ids} here~~ -->
  A character or numeric vector of group IDs, which contains exactly two unique
  values and whose length matches that of <code>file_list</code>. The two groups correspond to the two values of the binary variable of interest.</p></dd>

  <dt>groups</dt>
<dd><p><!-- %%     ~~Describe \code{groups} here~~ -->
  Deprecated. Does nothing. This argument was previously used to specify the values of <code>group_ids</code> corresponding to the two values of the binary variable of interest. These values are now determined automatically from the unique values of <code>group_ids</code>.</p></dd>

  <dt>seq_col</dt>
<dd><p><!-- %%     ~~Describe \code{seq_col} here~~ -->
    The name or index of of the column containing the clone sequences in the input data for each sample.</p></dd>

  <dt>freq_col</dt>
<dd><p><!-- %%     ~~Describe \code{freq_col} here~~ -->
    Optional. The name or index of the column containing the clone frequency/fraction (i.e., measure of clonal abundance normalized based on the total count in the sample) in the input data for each sample. If supplied, the maximum clone frequency (across all samples) for each associated sequence will be included in the content of the <code>label</code> variable of the returned data frame.</p></dd>

  <dt>min_seq_length</dt>
<dd><p><!-- %%     ~~Describe \code{min_seq_length} here~~ -->
    Passed to <code><a href="filterInputData.html">filterInputData</a></code>.</p></dd>

  <dt>drop_matches</dt>
<dd><p><!-- %%     ~~Describe \code{drop_matches} here~~ -->
    Passed to <code><a href="filterInputData.html">filterInputData</a></code>.</p></dd>

  <dt>min_sample_membership</dt>
<dd><p><!-- %%     ~~Describe \code{min_sample_membership} here~~ -->
    Only sequences that appear in at least this many samples will be considered. Setting this value to <code>NULL</code> bypasses the check.</p></dd>

  <dt>pval_cutoff</dt>
<dd><p><!-- %%     ~~Describe \code{pval_cutoff} here~~ -->
    Only sequences with Fisher's exact test $P$-value below this cutoff will be
    returned.</p></dd>

  <dt>outfile</dt>
<dd><p><!-- %%     ~~Describe \code{outfile} here~~ -->
    A file path used to save the data frame containing the associated sequences
    (using <code>write.csv</code>).</p></dd>

<dt>data</dt>
<dd><p>A data frame containing the combined AIRR-seq data for all samples,
    with variables indexed by column and observations indexed by row.</p></dd>

<dt>sample_col</dt>
<dd><p>The name or index of the column of <code>data</code> containing the sample IDs.</p></dd>

<dt>subject_col</dt>
<dd><p>Optional. The name or index of the column of <code>data</code> containing the subject IDs. Only relevant when the binary variable of interest is subject-specific and multiple samples belong to the same subject.</p></dd>

<dt>group_col</dt>
<dd><p>The name or index of the column of <code>data</code> containing the group IDs.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><!-- %%  ~~ If necessary, more details than the description above ~~ -->
    The list of unique receptor sequences is first filtered according to minimum sequence length and sequence content based on the specified values in <code>min_seq_length</code> and <code>drop_matches</code>, respectively. The list is then further filtered based on minimum sample membership, keeping
    only those receptor sequences that appear in at least <code>min_sample_membership</code>
    samples.</p>
<p>For each remaining sequence, a P-value is computed for Fisher's exact test of independence between the binary variable of interest and the appearance of the sequence within a repertoire. The test is performed using
    <code><a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">stats::fisher.test</a></code>, based on the number of samples possessing the
    sequence in each of the two groups. If subject IDs are provided, then the test is instead based on the number of subjects possessing the sequence in one or more samples. Only sequences
    with a \(P\)-value below <code>pval_cutoff</code> will be retained. The resulting
    sequences are sorted by \(P\)-value in increasing order and returned
    along with some basic meta-data.</p>
<p>The returned ouput is intended for use with the <code>findAssociatedClones</code> function. See the Finding Associated Clusters package vignette for more details. The vignette can be accessed using <code><a href="../articles/associated_clusters.html">vignette("associated_clusters")</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><!-- %%  ~Describe the value returned --></p>


<p><!-- %%  If it is a LIST, use --></p>


<p><!-- %%  \item{comp1 }{Description of 'comp1'} --></p>


<p><!-- %%  \item{comp2 }{Description of 'comp2'} --></p>


<p><!-- %% ... --></p>


<p>A data frame containing the receptor sequences found to be associated with the binary variable based on Fisher's exact test using the specified P-value cutoff. Each row corresponds to a unique sequence and includes the following variables:</p>
<dl><dt>ReceptorSeq</dt>
<dd><p>The unique receptor sequence</p></dd>

    <dt>fisher_pvalue</dt>
<dd><p>The P-value on Fisher's exact test for independence between the receptor sequence and the binary variable of interest</p></dd>

    <dt>shared_by_n_samples</dt>
<dd><p>The number of samples in which the sequence was observed</p></dd>

    <dt>samples_g0</dt>
<dd><p>Of the samples in which the sequence was observed, the number of samples belonging to the first group</p></dd>

    <dt>samples_g1</dt>
<dd><p>Of the samples in which the sequence was observed, the number of samples belonging to the second group</p></dd>

    <dt>shared_by_n_subjects</dt>
<dd><p>The number of subjects in which the sequence was observed (only present if subject IDs are specified)</p></dd>

    <dt>subjects_g0</dt>
<dd><p>Of the subjects in which the sequence was observed, the number of subjects belonging to the first group (only present if subject IDs are specified)</p></dd>

    <dt>subjects_g1</dt>
<dd><p>Of the subjects in which the sequence was observed, the number of subjects belonging to the second group (only present if subject IDs are specified)</p></dd>

    <dt>label</dt>
<dd><p>A character string summarizing the above information. Also includes the maximum in-sample clone frequency across all samples, if available</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Hai Yang, Jason Cham, Brian Neal, Zenghua Fan, Tao He and Li Zhang. (2023). NAIR: Network Analysis of Immune Repertoire. <em>Frontiers in Immunology</em>, vol. 14. https://doi.org/10.3389/fimmu.2023.1181825</p>
<p><a href="https://www.frontiersin.org/articles/10.3389/fimmu.2023.1181825" class="external-link">https://www.frontiersin.org/articles/10.3389/fimmu.2023.1181825</a></p>
<p><a href="https://github.com/mlizhangx/Network-Analysis-for-Repertoire-Sequencing-" class="external-link">https://github.com/mlizhangx/Network-Analysis-for-Repertoire-Sequencing-</a></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p><!-- %%  ~~who you are~~ -->
    Brian Neal (<a href="mailto:Brian.Neal@ucsf.edu">Brian.Neal@ucsf.edu</a>)</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><!-- %% ~~objects to See Also as \code{\link{help}}, ~~~ -->
<code><a href="findAssociatedClones.html">findAssociatedClones</a></code>
<code><a href="buildAssociatedClusterNetwork.html">buildAssociatedClusterNetwork</a></code>
<code><a href="../articles/associated_clusters.html">vignette("associated_clusters")</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co">## Generate some toy data for demonstration ##</span></span></span>
<span class="r-in"><span><span class="co"># Use temp dir</span></span></span>
<span class="r-in"><span><span class="va">data_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Directory to store input files</span></span></span>
<span class="r-in"><span><span class="va">dir_input_samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">data_dir</span>, <span class="st">"input_samples"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">dir_input_samples</span>, showWarnings <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Number of samples by control/treatment group</span></span></span>
<span class="r-in"><span><span class="va">samples_c</span> <span class="op">&lt;-</span> <span class="va">samples_t</span> <span class="op">&lt;-</span> <span class="fl">15</span></span></span>
<span class="r-in"><span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="va">samples_c</span> <span class="op">+</span> <span class="va">samples_t</span></span></span>
<span class="r-in"><span><span class="va">sample_size</span> <span class="op">&lt;-</span> <span class="fl">30</span> <span class="co"># (seqs per sample)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># sequences (first five are chosen to be associated with treatment)</span></span></span>
<span class="r-in"><span><span class="va">base_seqs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CASSGAYEQYF"</span>, <span class="st">"CSVDLGKGNNEQFF"</span>,</span></span>
<span class="r-in"><span>               <span class="st">"CASSIEGQLSTDTQYF"</span>,</span></span>
<span class="r-in"><span>               <span class="st">"CASSEEGQLSTDTQYF"</span>,</span></span>
<span class="r-in"><span>               <span class="st">"CASSPEGQLSTDTQYF"</span>,</span></span>
<span class="r-in"><span>               <span class="st">"RASSLAGNTEAFF"</span>, <span class="st">"CASSHRGTDTQYF"</span>, <span class="st">"CASDAGVFQPQHF"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># relative generation probabilities by control/treatment group</span></span></span>
<span class="r-in"><span><span class="va">pgen_c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>, times <span class="op">=</span> <span class="va">samples_c</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 nrow <span class="op">=</span> <span class="va">samples_c</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pgen_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>, times <span class="op">=</span> <span class="va">samples_t</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 nrow <span class="op">=</span> <span class="va">samples_t</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pgen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">pgen_c</span>, <span class="va">pgen_t</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simulate the data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="simulateToyData.html">simulateToyData</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  samples <span class="op">=</span> <span class="va">samples</span>, sample_size <span class="op">=</span> <span class="va">sample_size</span>,</span></span>
<span class="r-in"><span>  prefix_length <span class="op">=</span> <span class="fl">1</span>, prefix_chars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">""</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  prefix_probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">samples</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">samples</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  affixes <span class="op">=</span> <span class="va">base_seqs</span>, affix_probs <span class="op">=</span> <span class="va">pgen</span>, num_edits <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>  output_dir <span class="op">=</span> <span class="va">dir_input_samples</span>, no_return <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Find Associated Sequences ##</span></span></span>
<span class="r-in"><span><span class="co"># input files (one per sample)</span></span></span>
<span class="r-in"><span><span class="va">input_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">dir_input_samples</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Sample"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">samples</span>, <span class="st">".rds"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># group labels for the samples</span></span></span>
<span class="r-in"><span><span class="va">group_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"reference"</span>, <span class="va">samples_c</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"comparison"</span>, <span class="va">samples_t</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">associated_seqs</span> <span class="op">&lt;-</span> <span class="fu">findAssociatedSeqs</span><span class="op">(</span></span></span>
<span class="r-in"><span>  file_list <span class="op">=</span> <span class="va">input_files</span>, input_type <span class="op">=</span> <span class="st">"rds"</span>,</span></span>
<span class="r-in"><span>  group_ids <span class="op">=</span> <span class="va">group_labels</span>,</span></span>
<span class="r-in"><span>  seq_col <span class="op">=</span> <span class="st">"CloneSeq"</span>,</span></span>
<span class="r-in"><span>  min_seq_length <span class="op">=</span> <span class="cn">NULL</span>, drop_matches <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>  min_sample_membership <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>  pval_cutoff <span class="op">=</span> <span class="fl">0.1</span>,outfile <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Brian Neal, Hai Yang, Phi Long Le, Li Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

