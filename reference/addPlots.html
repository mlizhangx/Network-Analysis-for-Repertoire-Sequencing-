<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Generate Plots of a Network Graph — addPlots • NAIR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generate Plots of a Network Graph — addPlots"><meta name="description" content="Generates one or more
  ggraph plots of the network graph according to the user
  specifications.
addPlots() accepts and returns a list of network objects, adding
  the plots to the existing list contents. If the list already contains plots,
  the new plots will be created using the same coordinate layout as the
  existing plots.
generateNetworkGraphPlots() accepts the network
  igraph and node metadata,
  and returns a list containing plots."><meta property="og:description" content="Generates one or more
  ggraph plots of the network graph according to the user
  specifications.
addPlots() accepts and returns a list of network objects, adding
  the plots to the existing list contents. If the list already contains plots,
  the new plots will be created using the same coordinate layout as the
  existing plots.
generateNetworkGraphPlots() accepts the network
  igraph and node metadata,
  and returns a list containing plots."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">NAIR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.4.9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/NAIR.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/buildRepSeqNetwork.html">buildRepSeqNetwork()/buildNet()</a></li>
    <li><a class="dropdown-item" href="../articles/node_properties.html">Node-Level Network Properties</a></li>
    <li><a class="dropdown-item" href="../articles/cluster_analysis.html">Cluster Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/network_visualization.html">Network Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/supplementary.html">Supplementary Functions</a></li>
    <li><a class="dropdown-item" href="../articles/dual_chain.html">Dual-Chain Network Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/associated_clusters.html">Searching for Associated TCR/BCR Clusters</a></li>
    <li><a class="dropdown-item" href="../articles/public_clusters.html">Searching for Public TCR/BCR Clusters</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mlizhangx/Network-Analysis-for-Repertoire-Sequencing-/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Generate Plots of a Network Graph</h1>

      <div class="d-none name"><code>addPlots.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Generates one or more
  <code><a href="https://ggraph.data-imaginist.com/reference/ggraph.html" class="external-link">ggraph</a></code> plots of the network graph according to the user
  specifications.</p>
<p><code>addPlots()</code> accepts and returns a list of network objects, adding
  the plots to the existing list contents. If the list already contains plots,
  the new plots will be created using the same coordinate layout as the
  existing plots.</p>
<p><code>generateNetworkGraphPlots()</code> accepts the network
  <code><a href="https://r.igraph.org/reference/aaa-igraph-package.html" class="external-link">igraph</a></code> and node metadata,
  and returns a list containing plots.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">addPlots</span><span class="op">(</span></span>
<span>  <span class="va">net</span>,</span>
<span>  print_plots <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  plot_title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plot_subtitle <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  color_nodes_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  color_scheme <span class="op">=</span> <span class="st">"default"</span>,</span>
<span>  color_legend <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  color_title <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  edge_width <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  size_nodes_by <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  node_size_limits <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  size_title <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">generateNetworkGraphPlots</span><span class="op">(</span></span>
<span>  <span class="va">igraph</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  print_plots <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  plot_title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plot_subtitle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  color_nodes_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  color_scheme <span class="op">=</span> <span class="st">"default"</span>,</span>
<span>  color_legend <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  color_title <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  edge_width <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  size_nodes_by <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  node_size_limits <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  size_title <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  layout <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>



<dl><dt id="arg-net">net<a class="anchor" aria-label="anchor" href="#arg-net"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></code> of network objects conforming to the output of
      <code><a href="buildRepSeqNetwork.html">buildRepSeqNetwork()</a></code> or
      <code><a href="generateNetworkObjects.html">generateNetworkObjects()</a></code>.
      See details.</p></dd>


<dt id="arg-igraph">igraph<a class="anchor" aria-label="anchor" href="#arg-igraph"></a></dt>
<dd><p>An <code><a href="https://r.igraph.org/reference/aaa-igraph-package.html" class="external-link">igraph</a></code> object containing the network graph to be plotted.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame containing the node metadata for the network, with each row
  corresponding to a node.</p></dd>

<dt id="arg-print-plots">print_plots<a class="anchor" aria-label="anchor" href="#arg-print-plots"></a></dt>
<dd><p>A logical scalar; should plots be printed in the <code>R</code> plotting window?</p></dd>


<dt id="arg-plot-title">plot_title<a class="anchor" aria-label="anchor" href="#arg-plot-title"></a></dt>
<dd><p>A character string containing the plot title.</p></dd>


<dt id="arg-plot-subtitle">plot_subtitle<a class="anchor" aria-label="anchor" href="#arg-plot-subtitle"></a></dt>
<dd><p>A character string containing the plot subtitle. The default value
      <code>"auto"</code> generates a subtitle describing the settings used to
      construct the network,
      including the distance type and distance cutoff.</p></dd>


<dt id="arg-color-nodes-by">color_nodes_by<a class="anchor" aria-label="anchor" href="#arg-color-nodes-by"></a></dt>
<dd><p>A vector specifying one or more node metadata variables used to encode the
  color of the nodes. One plot is generated for each entry, with each plot
  coloring the nodes according to the variable in the corresponding entry.
  This argument accepts a character vector where each entry is a
  column name of the node metadata.
  If this argument is <code>NULL</code>, generates a single plot with uncolored nodes.</p></dd>


<dt id="arg-color-scheme">color_scheme<a class="anchor" aria-label="anchor" href="#arg-color-scheme"></a></dt>
<dd><p>A character string specifying the color scale to use for all plots, or a
  character vector whose length matches that of <code>color_nodes_by</code>, with each
  entry specifying the color scale for the corresponding plot.
  <code>"default"</code> specifies the default
  <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot()</a></code> color scale.
  Other options are one of the viridis color scales (e.g., <code>"plasma"</code>,
  <code>"A"</code> or other valid inputs to the <code>option</code> argument of
  <code><a href="https://sjmgarnier.github.io/viridis/reference/scale_viridis.html" class="external-link">scale_color_viridis()</a></code>)
  or (for discrete variables) a palette
  from <code><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.pals()</a></code> (e.g., <code>"RdYlGn"</code>).
  Each of the viridis color scales can include the suffix <code>"-1"</code>
  to reverse its direction (e.g., <code>"plasma-1"</code> or <code>"A-1"</code>).</p></dd>


<dt id="arg-color-legend">color_legend<a class="anchor" aria-label="anchor" href="#arg-color-legend"></a></dt>
<dd><p>A logical scalar specifying whether to display the color legend in plots.
    The default value of <code>"auto"</code> shows the color legend if nodes are colored
    according to a continuous variable or
    according to a discrete variable with at most 20 distinct values.</p></dd>


<dt id="arg-color-title">color_title<a class="anchor" aria-label="anchor" href="#arg-color-title"></a></dt>
<dd><p>A character string specifying the title of the color legend in all plots, or a
  character vector whose length matches that of <code>color_nodes_by</code>, with each
  entry specifying the title of the color legend in the corresponding plot.
  Only applicable for plots with colored nodes.
  The value <code>"auto"</code> uses the corresponding value of <code>color_nodes_by</code>.</p></dd>


<dt id="arg-edge-width">edge_width<a class="anchor" aria-label="anchor" href="#arg-edge-width"></a></dt>
<dd><p>A numeric scalar specifying the width of the graph edges in the plot.
      Passed to the <code>width</code> argument of
      <code><a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html" class="external-link">geom_edge_link0()</a></code>.</p></dd>


<dt id="arg-size-nodes-by">size_nodes_by<a class="anchor" aria-label="anchor" href="#arg-size-nodes-by"></a></dt>
<dd><p>A numeric scalar specifying the size of the nodes in all plots, or the column
  name of a node metadata variable used to encode the size of the nodes in all
  plots. Alternatively, an argument value of <code>NULL</code> uses the default
  <code><a href="https://ggraph.data-imaginist.com/reference/ggraph.html" class="external-link">ggraph</a></code> size for all nodes. Passed to the size aesthetic
  mapping of <code><a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html" class="external-link">geom_node_point()</a></code>.</p></dd>


<dt id="arg-node-size-limits">node_size_limits<a class="anchor" aria-label="anchor" href="#arg-node-size-limits"></a></dt>
<dd><p>A numeric vector of length 2, specifying the minimum and maximum node size.
    Only applicable if nodes are sized according to a variable.
    If <code>node_size_limits = NULL</code>, the default size scale will be used.</p></dd>


<dt id="arg-size-title">size_title<a class="anchor" aria-label="anchor" href="#arg-size-title"></a></dt>
<dd><p>A character string (or <code>NULL</code>) specifying the title for the size legend.
    Only applicable if nodes are sized according to a variable.
    The value <code>"auto"</code> uses the value of <code>size_nodes_by</code>.</p></dd>

<dt id="arg-layout">layout<a class="anchor" aria-label="anchor" href="#arg-layout"></a></dt>
<dd><p>A <code>matrix</code> specifying the coordinate layout of the network nodes,
  with one row for each node in the network and two columns.
  Each row specifies the x and y coordinates for the corresponding node.
  If <code>NULL</code>, the layout matrix is created using
  <code>[igraph:layout_components]{layout_components()}</code>.
  This argument can be used to
  create plots conforming to the same layout as previously-generated plots. It
  can also be used to generate plots with custom layouts.</p></dd>

  <dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, generates messages about the tasks
      performed and their progress, as well as relevant properties of intermediate
      outputs. Messages are sent to <code><a href="https://rdrr.io/r/base/showConnections.html" class="external-link">stderr()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The list <code>net</code> must contain the named elements
    <code>igraph</code> (of class <code><a href="https://r.igraph.org/reference/aaa-igraph-package.html" class="external-link">igraph</a></code>),
    <code>adjacency_matrix</code> (a <code><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></code> or
    <code><a href="https://rdrr.io/pkg/Matrix/man/dgCMatrix-class.html" class="external-link">dgCMatrix</a></code> encoding edge connections),
    and <code>node_data</code> (a <code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></code> containing node metadata),
    all corresponding to the same network. The lists returned by
    <code><a href="buildRepSeqNetwork.html">buildRepSeqNetwork()</a></code> and
    <code><a href="generateNetworkObjects.html">generateNetworkObjects()</a></code>
    are examples of valid inputs for the <code>net</code> argument.</p>
<p>The arguments <code>color_nodes_by</code> and <code>size_nodes_by</code> accept
    the names of variables in the node metadata.
    For <code>addPlots()</code>, this is the data frame <code>node_data</code>
    contained in the list provided to the <code>net</code> argument.
    For <code>generateNetworkGraphPlots()</code>, this is the data frame provided
    to the <code>data</code> argument.</p>
<p><code>addPlots()</code> adds the generated plots to the list <code>plots</code> contained
    in the list of network objects provided to <code>net</code>.
    The <code>plots</code> element is created if it does not already exist.
    If plots already exist, the new plots will be generated with the same
    coordinate layout as the existing plots.
    Each plot is named according to the variable used to color the nodes.
    If a plot already exists with the same name as one of the new plots,
    it will be overwritten with the new plot.
    If the <code>plots</code> list does not already contain an element named
    <code>graph_layout</code>, it will be added. This element contains the coordinate
    layout for the plots as a two-column matrix.</p>
<p>When calling <code>generateNetworkGraphPlots()</code>, if one wishes for the plots
    to be generated with the same coordinate layout as an existing plot, the
    layout matrix for the existing plot must be passed to the <code>layout</code>
    argument.</p>
<p>The plots can be printed to a pdf using
    <code><a href="saveNetworkPlots.html">saveNetworkPlots()</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>addPlots()</code> returns a modified copy of <code>net</code> with the new plots
  contained in the element named <code>plots</code> (a list), in addition to any
  previously existing plots.</p>
<p><code>generateNetworkGraphPlots()</code> returns a list containing the new plots.</p>
<p>Each plot is an object of class <code>ggraph</code>. Within the list of plots,
  each plot is named after the variable used to color the nodes.
  For a plot with uncolored nodes, the name is <code>uniform_color</code>.</p>
<p>The list containing the new plots also contains an element named
  <code>graph_layout</code>. This is
  a matrix specifying the coordinate layout of the nodes in the plots.
  It contains one row for each node in the
  network and two columns. Each row specifies the x and y coordinates for the
  corresponding node. This matrix can be used to generate additional plots with
  the same layout as the plots in the returned list.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Hai Yang, Jason Cham, Brian Neal, Zenghua Fan, Tao He and Li Zhang. (2023).
NAIR: Network Analysis of Immune Repertoire. <em>Frontiers in Immunology</em>, vol. 14.
<a href="https://www.frontiersin.org/articles/10.3389/fimmu.2023.1181825/full" class="external-link">doi: 10.3389/fimmu.2023.1181825</a></p>
<p><a href="https://mlizhangx.github.io/Network-Analysis-for-Repertoire-Sequencing-/index.html">Webpage for the NAIR package</a></p>
<p><a href="https://mlizhangx.github.io/Network-Analysis-for-Repertoire-Sequencing-/articles/network_visualization.html">Network Visualization article on package website</a></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Brian Neal (<a href="mailto:Brian.Neal@ucsf.edu">Brian.Neal@ucsf.edu</a>)</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="addGraphLabels.html">labelNodes()</a></code>
  <code><a href="addClusterLabels.html">labelClusters()</a></code>
  <code><a href="saveNetworkPlots.html">saveNetworkPlots()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">toy_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="simulateToyData.html">simulateToyData</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">net</span> <span class="op">&lt;-</span> <span class="fu"><a href="buildRepSeqNetwork.html">buildNet</a></span><span class="op">(</span><span class="va">toy_data</span>, <span class="st">"CloneSeq"</span>, node_stats <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">net</span> <span class="op">&lt;-</span> <span class="fu">addPlots</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">net</span>,</span></span>
<span class="r-in"><span>  color_nodes_by <span class="op">=</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SampleID"</span>, <span class="st">"transitivity"</span>, <span class="st">"coreness"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  color_scheme <span class="op">=</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Set 2"</span>, <span class="st">"mako-1"</span>, <span class="st">"plasma-1"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  color_title <span class="op">=</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"Transitvity"</span>, <span class="st">"Coreness"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  size_nodes_by <span class="op">=</span> <span class="st">"degree"</span>,</span></span>
<span class="r-in"><span>  node_size_limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  plot_subtitle <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>  print_plots <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="addPlots-1.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="addPlots-2.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="addPlots-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Brian Neal, Hai Yang, Daniil Matveev, Phi Long Le, Li Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

