<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Given a list of receptor sequences, computes the adjacency matrix for the
network graph based on sequence similarity.
sparseAdjacencyMatFromSeqs() is a deprecated equivalent of
generateAdjacencyMatrix()."><title>Compute Graph Adjacency Matrix for Immune Repertoire Network — generateAdjacencyMatrix • NAIR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute Graph Adjacency Matrix for Immune Repertoire Network — generateAdjacencyMatrix"><meta property="og:description" content="Given a list of receptor sequences, computes the adjacency matrix for the
network graph based on sequence similarity.
sparseAdjacencyMatFromSeqs() is a deprecated equivalent of
generateAdjacencyMatrix()."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">NAIR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.4.9001</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/NAIR.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/buildRepSeqNetwork.html">buildRepSeqNetwork()/buildNet()</a>
    <a class="dropdown-item" href="../articles/node_properties.html">Node-Level Network Properties</a>
    <a class="dropdown-item" href="../articles/cluster_analysis.html">Cluster Analysis</a>
    <a class="dropdown-item" href="../articles/network_visualization.html">Network Visualization</a>
    <a class="dropdown-item" href="../articles/supplementary.html">Supplementary Functions</a>
    <a class="dropdown-item" href="../articles/dual_chain.html">Dual-Chain Network Analysis</a>
    <a class="dropdown-item" href="../articles/associated_clusters.html">Searching for Associated TCR/BCR Clusters</a>
    <a class="dropdown-item" href="../articles/public_clusters.html">Searching for Public TCR/BCR Clusters</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mlizhangx/Network-Analysis-for-Repertoire-Sequencing-/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Compute Graph Adjacency Matrix for Immune Repertoire Network</h1>
      
      <div class="d-none name"><code>generateAdjacencyMatrix.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Given a list of receptor sequences, computes the adjacency matrix for the
network graph based on sequence similarity.</p>
<p><code>sparseAdjacencyMatFromSeqs()</code> is a deprecated equivalent of
<code>generateAdjacencyMatrix()</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">generateAdjacencyMatrix</span><span class="op">(</span></span>
<span>  <span class="va">seqs</span>,</span>
<span>  dist_type <span class="op">=</span> <span class="st">"hamming"</span>,</span>
<span>  dist_cutoff <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  drop_isolated_nodes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"default"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Deprecated equivalent:</span></span>
<span><span class="fu">sparseAdjacencyMatFromSeqs</span><span class="op">(</span></span>
<span>  <span class="va">seqs</span>,</span>
<span>  dist_type <span class="op">=</span> <span class="st">"hamming"</span>,</span>
<span>  dist_cutoff <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  drop_isolated_nodes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"default"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  max_dist <span class="op">=</span> <span class="fu">deprecated</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>seqs</dt>
<dd><p>A character vector containing the receptor sequences.</p></dd>

  <dt>dist_type</dt>
<dd><p>Specifies the function used to quantify the similarity between sequences. The
similarity between two sequences determines the pairwise distance between their
respective nodes in the network graph, with greater similarity corresponding to
shorter distance. Valid options are <code>"hamming"</code> (the default), which uses
<code><a href="hamDistBounded.html">hamDistBounded</a></code>, and <code>"levenshtein"</code>, which uses
<code><a href="levDistBounded.html">levDistBounded</a></code>.</p></dd>

  <dt>dist_cutoff</dt>
<dd><p>A nonnegative scalar. Specifies the maximum pairwise distance (based on
<code>dist_type</code>) for an edge connection to exist between two nodes. Pairs of
nodes whose distance is less than or equal to this value will be joined by an
edge connection in the network graph. Controls the stringency of the network
construction and affects the number and density of edges in the network. A lower
cutoff value requires greater similarity between sequences in order for their
respective nodes to be joined by an edge connection. A value of <code>0</code> requires
two sequences to be identical in order for their nodes to be joined by an edge.</p></dd>

  <dt>drop_isolated_nodes</dt>
<dd><p>Logical. When <code>TRUE</code>, removes each node that is not joined by an
edge connection to any other node in the network graph.</p></dd>

  <dt>method</dt>
<dd><p>A character string specifying the algorithm to use. Choices are <code>"default"</code> and  <code>"pattern"</code>. <code>"pattern"</code> is only valid when <code>dist_cutoff &lt; 3</code>, but tends to be faster than <code>"default"</code> for sparsely connected networks, at the cost of greater memory usage (can cause crashes for large or densely-connected networks, particularly for <code>dist_cutoff = 2</code>). The default algorithm tends to be faster for densely-connected networks or long sequences.</p></dd>

  <dt>verbose</dt>
<dd><p>Logical. If <code>TRUE</code>, generates messages about the tasks
      performed and their progress, as well as relevant properties of intermediate
      outputs. Messages are sent to <code><a href="https://rdrr.io/r/base/showConnections.html" class="external-link">stderr</a></code>.</p></dd>

  <dt>max_dist</dt>
<dd><p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated" class="external-link"><img src="figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a>
      Equivalent to <code>dist_cutoff</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The adjacency matrix of a graph with \(n\) nodes is the symmetric
\(n \times n\) matrix for which entry \((i,j)\) is equal to 1 if nodes
\(i\) and \(j\) are connected by an edge in the network graph and 0 otherwise.</p>
<p>To construct the graph of the immune repertoire network, each receptor sequence
is modeled as a node. The similarity between receptor sequences, as measured
using either the Hamming or Levenshtein distance, determines the distance between
nodes in the network graph. The more similar two sequences are, the shorter the
distance between their respective nodes. Two nodes in the graph are joined by an
edge if the distance between them is sufficiently small, i.e., if their receptor
sequences are sufficiently similar.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A sparse matrix of class <code>dgCMatrix</code></p>


<p>(see <code><a href="https://rdrr.io/pkg/Matrix/man/dgCMatrix-class.html" class="external-link">dgCMatrix-class</a></code>).</p>


<p>If <code>drop_isolated_nodes = TRUE</code>, the row and column names of the matrix
indicate which receptor sequences in the <code>seqs</code> vector correspond to each
row and column of the matrix. The row and column names can be accessed using
<code><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></code>. This returns a list containing two character vectors,
one for the row names and one for the column names. The name of the \(i\)th
matrix row is the index of the <code>seqs</code> vector corresponding to the \(i\)th
row and \(i\)th column of the matrix. The  name of the \(j\)th matrix column
is the receptor sequence corresponding to the \(j\)th row and \(j\)th column
of the matrix.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Hai Yang, Jason Cham, Brian Neal, Zenghua Fan, Tao He and Li Zhang. (2023).
NAIR: Network Analysis of Immune Repertoire. <em>Frontiers in Immunology</em>, vol. 14.
<a href="https://www.frontiersin.org/articles/10.3389/fimmu.2023.1181825/full" class="external-link">doi: 10.3389/fimmu.2023.1181825</a></p>
<p><a href="https://mlizhangx.github.io/Network-Analysis-for-Repertoire-Sequencing-/index.html">Webpage for the NAIR package</a></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Brian Neal (<a href="mailto:Brian.Neal@ucsf.edu">Brian.Neal@ucsf.edu</a>)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">generateAdjacencyMatrix</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fee"</span>, <span class="st">"fie"</span>, <span class="st">"foe"</span>, <span class="st">"fum"</span>, <span class="st">"foo"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 x 4 sparse Matrix of class "dgCMatrix"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   fee fie foe foo</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   1   1   1   .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   1   1   1   .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   1   1   1   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   .   .   1   1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># No edge connections exist based on a Hamming distance of 1</span></span></span>
<span class="r-in"><span><span class="co"># (returns a 0x0 sparse matrix)</span></span></span>
<span class="r-in"><span><span class="fu">generateAdjacencyMatrix</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"foo"</span>, <span class="st">"foobar"</span>, <span class="st">"fubar"</span>, <span class="st">"bar"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>No edges exist using the specified distance cutoff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0 x 0 sparse Matrix of class "dgCMatrix"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;0 x 0 matrix&gt;</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Same as the above example, but keeping all nodes</span></span></span>
<span class="r-in"><span><span class="co"># (returns a 4x4 sparse matrix)</span></span></span>
<span class="r-in"><span><span class="fu">generateAdjacencyMatrix</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"foo"</span>, <span class="st">"foobar"</span>, <span class="st">"fubar"</span>, <span class="st">"bar"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  drop_isolated_nodes <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 x 4 sparse Matrix of class "dgCMatrix"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 1 . . .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] . 1 . .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] . . 1 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] . . . 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Relaxing the edge criteria using a Hamming distance of 2</span></span></span>
<span class="r-in"><span><span class="co"># (still results in no edge connections)</span></span></span>
<span class="r-in"><span><span class="fu">generateAdjacencyMatrix</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"foo"</span>, <span class="st">"foobar"</span>, <span class="st">"fubar"</span>, <span class="st">"bar"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  dist_cutoff <span class="op">=</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>No edges exist using the specified distance cutoff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0 x 0 sparse Matrix of class "dgCMatrix"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;0 x 0 matrix&gt;</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Using a Levenshtein distance of 2, however,</span></span></span>
<span class="r-in"><span><span class="co"># does result in edge connections</span></span></span>
<span class="r-in"><span><span class="fu">generateAdjacencyMatrix</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"foo"</span>, <span class="st">"foobar"</span>, <span class="st">"fubar"</span>, <span class="st">"bar"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  dist_type <span class="op">=</span> <span class="st">"levenshtein"</span>,</span></span>
<span class="r-in"><span>  dist_cutoff <span class="op">=</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 x 3 sparse Matrix of class "dgCMatrix"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   foobar fubar bar</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      1     1   .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      1     1   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      .     1   1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Using a Hamming distance of 3</span></span></span>
<span class="r-in"><span><span class="co"># also results in (different) edge connections</span></span></span>
<span class="r-in"><span><span class="fu">generateAdjacencyMatrix</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"foo"</span>, <span class="st">"foobar"</span>, <span class="st">"fubar"</span>, <span class="st">"bar"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  dist_cutoff <span class="op">=</span> <span class="fl">3</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 x 3 sparse Matrix of class "dgCMatrix"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   foo foobar bar</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   1      1   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   1      1   .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   1      .   1</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Brian Neal, Hai Yang, Daniil Matveev, Phi Long Le, Li Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

