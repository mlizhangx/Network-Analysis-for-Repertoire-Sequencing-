<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Identify TCR/BCR Clones in a Neighborhood Around Each Associated Sequence — findAssociatedClones • NAIR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Identify TCR/BCR Clones in a Neighborhood Around Each Associated Sequence — findAssociatedClones"><meta name="description" content='Part of the workflow
Searching for Associated TCR/BCR Clusters.
Intended for use following findAssociatedSeqs()
and prior to
buildAssociatedClusterNetwork().
Given multiple samples of bulk Adaptive Immune Receptor Repertoire Sequencing
(AIRR-Seq) data and a vector of associated sequences, identifies for each
associated sequence a global "neighborhood" comprised of clones with TCR/BCR
sequences similar to the associated sequence.'><meta property="og:description" content='Part of the workflow
Searching for Associated TCR/BCR Clusters.
Intended for use following findAssociatedSeqs()
and prior to
buildAssociatedClusterNetwork().
Given multiple samples of bulk Adaptive Immune Receptor Repertoire Sequencing
(AIRR-Seq) data and a vector of associated sequences, identifies for each
associated sequence a global "neighborhood" comprised of clones with TCR/BCR
sequences similar to the associated sequence.'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">NAIR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.4.9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/NAIR.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/buildRepSeqNetwork.html">buildRepSeqNetwork()/buildNet()</a></li>
    <li><a class="dropdown-item" href="../articles/node_properties.html">Node-Level Network Properties</a></li>
    <li><a class="dropdown-item" href="../articles/cluster_analysis.html">Cluster Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/network_visualization.html">Network Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/supplementary.html">Supplementary Functions</a></li>
    <li><a class="dropdown-item" href="../articles/dual_chain.html">Dual-Chain Network Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/associated_clusters.html">Searching for Associated TCR/BCR Clusters</a></li>
    <li><a class="dropdown-item" href="../articles/public_clusters.html">Searching for Public TCR/BCR Clusters</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mlizhangx/Network-Analysis-for-Repertoire-Sequencing-/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Identify TCR/BCR Clones in a Neighborhood Around Each Associated Sequence</h1>

      <div class="d-none name"><code>findAssociatedClones.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Part of the workflow
<a href="https://mlizhangx.github.io/Network-Analysis-for-Repertoire-Sequencing-/articles/associated_clusters.html">Searching for Associated TCR/BCR Clusters</a>.
Intended for use following <code><a href="findAssociatedSeqs.html">findAssociatedSeqs()</a></code>
and prior to
<code><a href="buildAssociatedClusterNetwork.html">buildAssociatedClusterNetwork()</a></code>.</p>
<p>Given multiple samples of bulk Adaptive Immune Receptor Repertoire Sequencing
(AIRR-Seq) data and a vector of associated sequences, identifies for each
associated sequence a global "neighborhood" comprised of clones with TCR/BCR
sequences similar to the associated sequence.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">findAssociatedClones</span><span class="op">(</span></span>
<span></span>
<span>  <span class="co">## Input ##</span></span>
<span>  <span class="va">file_list</span>, <span class="va">input_type</span>,</span>
<span>  data_symbols <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">header</span>, <span class="va">sep</span>, <span class="va">read.args</span>,</span>
<span>  sample_ids <span class="op">=</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Sample"</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">file_list</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  subject_ids <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">group_ids</span>,</span>
<span>  <span class="va">seq_col</span>,</span>
<span>  <span class="va">assoc_seqs</span>,</span>
<span></span>
<span>  <span class="co">## Neighborhood Criteria ##</span></span>
<span>  nbd_radius <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  dist_type <span class="op">=</span> <span class="st">"hamming"</span>,</span>
<span>  min_seq_length <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  drop_matches <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span></span>
<span>  <span class="co">## Output ##</span></span>
<span>  subset_cols <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">output_dir</span>,</span>
<span>  output_type <span class="op">=</span> <span class="st">"rds"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-file-list">file_list<a class="anchor" aria-label="anchor" href="#arg-file-list"></a></dt>
<dd><p>A character vector of file paths, or a list containing
  <code><a href="https://rdrr.io/r/base/connections.html" class="external-link">connections</a></code> and file paths.
  Each element corresponds to a single file containing the data
  for a single sample.
  Passed to <code><a href="combineSamples.html">loadDataFromFileList()</a></code>.</p></dd>

  <dt id="arg-input-type">input_type<a class="anchor" aria-label="anchor" href="#arg-input-type"></a></dt>
<dd><p>A character string specifying the file format of the sample data files. Options
  are <code>"table"</code>, <code>"txt"</code>, <code>"tsv"</code>, <code>"csv"</code>, <code>"rds"</code> and
  <code>"rda"</code>.
  Passed to <code><a href="combineSamples.html">loadDataFromFileList()</a></code>.</p></dd>

  <dt id="arg-data-symbols">data_symbols<a class="anchor" aria-label="anchor" href="#arg-data-symbols"></a></dt>
<dd><p>Used when <code>input_type = "rda"</code>. Specifies the name of each sample's data
  frame within its respective Rdata file.
  Passed to <code><a href="combineSamples.html">loadDataFromFileList()</a></code>.</p></dd>

  <dt id="arg-header">header<a class="anchor" aria-label="anchor" href="#arg-header"></a></dt>
<dd><p>For values of <code>input_type</code> other than <code>"rds"</code> and <code>"rda"</code>,
    this argument can be used to specify a non-default value of the <code>header</code>
    argument to <code><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table()</a></code>,
    <code><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv()</a></code>, etc.</p></dd>

  <dt id="arg-sep">sep<a class="anchor" aria-label="anchor" href="#arg-sep"></a></dt>
<dd><p>For values of <code>input_type</code> other than <code>"rds"</code> and <code>"rda"</code>,
    this argument can be used to specify a non-default value of the <code>sep</code>
    argument to <code><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table()</a></code>,
    <code><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv()</a></code>, etc.</p></dd>

  <dt id="arg-read-args">read.args<a class="anchor" aria-label="anchor" href="#arg-read-args"></a></dt>
<dd><p>For values of <code>input_type</code> other than <code>"rds"</code> and <code>"rda"</code>,
    this argument can be used to specify non-default values of optional
    arguments to <code><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table()</a></code>,
    <code><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv()</a></code>, etc.
    Accepts a named list of argument values.
    Values of <code>header</code> and <code>sep</code>
    in this list take precedence over values specified via the <code>header</code>
    and <code>sep</code> arguments.</p></dd>

  <dt id="arg-sample-ids">sample_ids<a class="anchor" aria-label="anchor" href="#arg-sample-ids"></a></dt>
<dd><p>A character or numeric vector of sample IDs, whose length matches that of
  <code>file_list</code>. Each entry is assigned as the sample ID to the corresponding
  entry of <code>file_list</code>.</p></dd>

  <dt id="arg-subject-ids">subject_ids<a class="anchor" aria-label="anchor" href="#arg-subject-ids"></a></dt>
<dd><p>An optional character or numeric vector of subject IDs, whose length matches
  that of <code>file_list</code>. Used to assign a subject ID to each sample.</p></dd>

  <dt id="arg-group-ids">group_ids<a class="anchor" aria-label="anchor" href="#arg-group-ids"></a></dt>
<dd><p>A character or numeric vector of group IDs whose length matches that of
  <code>file_list</code>. Used to assign each sample to a group. The two groups
  represent the levels of the binary variable of interest.</p></dd>

  <dt id="arg-seq-col">seq_col<a class="anchor" aria-label="anchor" href="#arg-seq-col"></a></dt>
<dd><p>Specifies the column of each sample's data frame containing the TCR/BCR
    sequences.
    Accepts a character string containing the column name
      or a numeric scalar containing the column index.</p></dd>

  <dt id="arg-assoc-seqs">assoc_seqs<a class="anchor" aria-label="anchor" href="#arg-assoc-seqs"></a></dt>
<dd><p>A character vector containing the TCR/BCR sequences associated with the
    binary variable of interest.</p></dd>

  <dt id="arg-nbd-radius">nbd_radius<a class="anchor" aria-label="anchor" href="#arg-nbd-radius"></a></dt>
<dd><p>The maximum distance (based on <code>dist_type</code>) between an associated sequence
    and other TCR/BCR sequences belonging to its neighborhood. Lower values require
    sequences to be more similar to an associated sequence in order to belong to
    its neighborhood.</p></dd>

  <dt id="arg-dist-type">dist_type<a class="anchor" aria-label="anchor" href="#arg-dist-type"></a></dt>
<dd><p>Specifies the function used to quantify the similarity between sequences. The
    similarity between two sequences determines their pairwise distance, with
    greater similarity corresponding to shorter distance. Valid options are
    <code>"hamming"</code> (the default), which
    uses <code><a href="hamDistBounded.html">hamDistBounded()</a></code>,
    and <code>"levenshtein"</code>, which uses
    <code><a href="levDistBounded.html">levDistBounded()</a></code>.</p></dd>

  <dt id="arg-min-seq-length">min_seq_length<a class="anchor" aria-label="anchor" href="#arg-min-seq-length"></a></dt>
<dd><p>Clones with TCR/BCR sequences below this length will be removed. Passed to
    <code><a href="filterInputData.html">filterInputData()</a></code> when loading each sample.</p></dd>

  <dt id="arg-drop-matches">drop_matches<a class="anchor" aria-label="anchor" href="#arg-drop-matches"></a></dt>
<dd><p>Passed to <code><a href="filterInputData.html">filterInputData()</a></code>.
    Accepts a character string containing a regular expression
    (see <code><a href="https://rdrr.io/r/base/regex.html" class="external-link">regex</a></code>).
    Checks TCR/BCR sequences for a pattern match using <code><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep()</a></code>.
    Those returning a match are dropped.
    By default, sequences containing any of the characters <code>*</code>, <code>|</code>
    or <code>_</code> are dropped.</p></dd>

  <dt id="arg-subset-cols">subset_cols<a class="anchor" aria-label="anchor" href="#arg-subset-cols"></a></dt>
<dd><p>Controls which columns of the AIRR-Seq data from each sample are included in
    the output.
    Accepts a character vector of column names
    or a numeric vector of column indices.
    The default <code>NULL</code> includes all columns. Passed to
    <code><a href="filterInputData.html">filterInputData()</a></code>.</p></dd>

  <dt id="arg-output-dir">output_dir<a class="anchor" aria-label="anchor" href="#arg-output-dir"></a></dt>
<dd><p>A file path to a directory for saving the output. A valid output directory is
  required, since no output is returned in R. The specified directory will be
  created if it does not already exist.</p></dd>

  <dt id="arg-output-type">output_type<a class="anchor" aria-label="anchor" href="#arg-output-type"></a></dt>
<dd><p>A character string specifying the file format to use for saving the output.
  Valid options are
  <code>"rda"</code>, <code>"csv"</code>, <code>"csv2"</code>, <code>"tsv"</code> and<code>"table"</code>.
  For <code>"rda"</code>, data frames are named <code>data</code> in the R environment.
  For the remaining options, <code><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.table()</a></code> is
  called with <code>row.names = TRUE</code>.</p></dd>

  <dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, generates messages about the tasks
  performed and their progress, as well as relevant properties of intermediate
  outputs. Messages are sent to <code><a href="https://rdrr.io/r/base/showConnections.html" class="external-link">stderr()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For each associated sequence, its neighborhood is defined to include all
clones with TCR/BCR sequences that are sufficiently similar to the associated
sequence. The arguments <code>dist_type</code> and <code>nbd_radius</code> control how the
similarity is measured and the degree of similarity required for neighborhood
membership.</p>
<p>For each associated sequence, a data frame is saved to an individual file.
The data frame contains one row for each clone in the associated sequence's
neighborhood (from all samples). It includes variables for sample ID, group ID
and (if provided) subject ID, as well as variables from the AIRR-Seq data.</p>
<p>The files saved by this function are intended for use with
<code><a href="buildAssociatedClusterNetwork.html">buildAssociatedClusterNetwork()</a></code>. See the
<a href="https://mlizhangx.github.io/Network-Analysis-for-Repertoire-Sequencing-/articles/associated_clusters.html">Searching for Associated TCR/BCR Clusters</a>
article on the package website for more details.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns <code>TRUE</code>, invisibly. The function is called for its side effects.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Hai Yang, Jason Cham, Brian Neal, Zenghua Fan, Tao He and Li Zhang. (2023).
NAIR: Network Analysis of Immune Repertoire. <em>Frontiers in Immunology</em>, vol. 14.
<a href="https://www.frontiersin.org/articles/10.3389/fimmu.2023.1181825/full" class="external-link">doi: 10.3389/fimmu.2023.1181825</a></p>
<p><a href="https://mlizhangx.github.io/Network-Analysis-for-Repertoire-Sequencing-/index.html">Webpage for the NAIR package</a></p>
<p><a href="https://mlizhangx.github.io/Network-Analysis-for-Repertoire-Sequencing-/articles/associated_clusters.html">Searching for Associated TCR/BCR Clusters article on package website</a></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Brian Neal (<a href="mailto:Brian.Neal@ucsf.edu">Brian.Neal@ucsf.edu</a>)</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="findAssociatedSeqs.html">findAssociatedSeqs()</a></code>
<code><a href="buildAssociatedClusterNetwork.html">buildAssociatedClusterNetwork()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Simulate 30 samples from two groups (treatment/control) ##</span></span></span>
<span class="r-in"><span><span class="va">n_control</span> <span class="op">&lt;-</span> <span class="va">n_treatment</span> <span class="op">&lt;-</span> <span class="fl">15</span></span></span>
<span class="r-in"><span><span class="va">n_samples</span> <span class="op">&lt;-</span> <span class="va">n_control</span> <span class="op">+</span> <span class="va">n_treatment</span></span></span>
<span class="r-in"><span><span class="va">sample_size</span> <span class="op">&lt;-</span> <span class="fl">30</span> <span class="co"># (seqs per sample)</span></span></span>
<span class="r-in"><span><span class="va">base_seqs</span> <span class="op">&lt;-</span> <span class="co"># first five are associated with treatment</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CASSGAYEQYF"</span>, <span class="st">"CSVDLGKGNNEQFF"</span>, <span class="st">"CASSIEGQLSTDTQYF"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"CASSEEGQLSTDTQYF"</span>, <span class="st">"CASSPEGQLSTDTQYF"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"RASSLAGNTEAFF"</span>, <span class="st">"CASSHRGTDTQYF"</span>, <span class="st">"CASDAGVFQPQHF"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Relative generation probabilities by control/treatment group</span></span></span>
<span class="r-in"><span><span class="va">pgen_c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>, times <span class="op">=</span> <span class="va">n_control</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 nrow <span class="op">=</span> <span class="va">n_control</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pgen_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>, times <span class="op">=</span> <span class="va">n_treatment</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 nrow <span class="op">=</span> <span class="va">n_treatment</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pgen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">pgen_c</span>, <span class="va">pgen_t</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="simulateToyData.html">simulateToyData</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  samples <span class="op">=</span> <span class="va">n_samples</span>,</span></span>
<span class="r-in"><span>  sample_size <span class="op">=</span> <span class="va">sample_size</span>,</span></span>
<span class="r-in"><span>  prefix_length <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  prefix_chars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">""</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  prefix_probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n_samples</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n_samples</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  affixes <span class="op">=</span> <span class="va">base_seqs</span>,</span></span>
<span class="r-in"><span>  affix_probs <span class="op">=</span> <span class="va">pgen</span>,</span></span>
<span class="r-in"><span>  num_edits <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>  output_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  no_return <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Step 1: Find Associated Sequences ##</span></span></span>
<span class="r-in"><span><span class="va">sample_files</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Sample"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">n_samples</span>, <span class="st">".rds"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">group_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"reference"</span>, <span class="va">n_control</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"comparison"</span>, <span class="va">n_treatment</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">associated_seqs</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="findAssociatedSeqs.html">findAssociatedSeqs</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    file_list <span class="op">=</span> <span class="va">sample_files</span>,</span></span>
<span class="r-in"><span>    input_type <span class="op">=</span> <span class="st">"rds"</span>,</span></span>
<span class="r-in"><span>    group_ids <span class="op">=</span> <span class="va">group_labels</span>,</span></span>
<span class="r-in"><span>    seq_col <span class="op">=</span> <span class="st">"CloneSeq"</span>,</span></span>
<span class="r-in"><span>    min_seq_length <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>    drop_matches <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>    min_sample_membership <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>    pval_cutoff <span class="op">=</span> <span class="fl">0.1</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">associated_seqs</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        ReceptorSeq fisher_pvalue shared_by_n_samples samples_g0 samples_g1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   CSVDLGKGNNEQFF  1.052106e-05                  18          3         15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      CASSGAYEQYF  1.157316e-04                  17          3         14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 CASSEEGQLSTDTQYF  5.197401e-03                  10          1          9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 CASSIEGQLSTDTQYF  6.559548e-02                  16          5         11</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Step 2: Find Associated Clones ##</span></span></span>
<span class="r-in"><span><span class="va">dir_step2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">findAssociatedClones</span><span class="op">(</span></span></span>
<span class="r-in"><span>  file_list <span class="op">=</span> <span class="va">sample_files</span>,</span></span>
<span class="r-in"><span>  input_type <span class="op">=</span> <span class="st">"rds"</span>,</span></span>
<span class="r-in"><span>  group_ids <span class="op">=</span> <span class="va">group_labels</span>,</span></span>
<span class="r-in"><span>  seq_col <span class="op">=</span> <span class="st">"CloneSeq"</span>,</span></span>
<span class="r-in"><span>  assoc_seqs <span class="op">=</span> <span class="va">associated_seqs</span><span class="op">$</span><span class="va">ReceptorSeq</span>,</span></span>
<span class="r-in"><span>  min_seq_length <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>  drop_matches <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>  output_dir <span class="op">=</span> <span class="va">dir_step2</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Step 3: Global Network of Associated Clusters ##</span></span></span>
<span class="r-in"><span><span class="va">associated_clusters</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="buildAssociatedClusterNetwork.html">buildAssociatedClusterNetwork</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    file_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">dir_step2</span>,</span></span>
<span class="r-in"><span>                           full.names <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>,</span></span>
<span class="r-in"><span>    seq_col <span class="op">=</span> <span class="st">"CloneSeq"</span>,</span></span>
<span class="r-in"><span>    size_nodes_by <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    print_plots <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-plt img"><img src="findAssociatedClones-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Brian Neal, Hai Yang, Daniil Matveev, Phi Long Le, Li Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

