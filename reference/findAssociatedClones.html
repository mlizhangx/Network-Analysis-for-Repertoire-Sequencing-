<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="
    Given multiple samples of RepSeq data from two groups and a list of receptor
    sequences associated to the comparison group (e.g., obtained using
    findAssociatedSeqs), this function does the following:
    for each associated sequence,
    from all samples that possess the associated sequence, gather the RepSeq data
    for all clones whose receptor sequences lie in a neighborhood of the associated sequence.
The RepSeq data for each neighborhood's associated sequence is then stored in its own data frame
    and saved to its own file, in preparation for use with
    buildAssociatedClusterNetwork."><title>
    Gather Clones in Public Neighborhoods Around Associated Sequences — findAssociatedClones • NAIR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="
    Gather Clones in Public Neighborhoods Around Associated Sequences — findAssociatedClones"><meta property="og:description" content="
    Given multiple samples of RepSeq data from two groups and a list of receptor
    sequences associated to the comparison group (e.g., obtained using
    findAssociatedSeqs), this function does the following:
    for each associated sequence,
    from all samples that possess the associated sequence, gather the RepSeq data
    for all clones whose receptor sequences lie in a neighborhood of the associated sequence.
The RepSeq data for each neighborhood's associated sequence is then stored in its own data frame
    and saved to its own file, in preparation for use with
    buildAssociatedClusterNetwork."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">NAIR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.9041</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/NAIR.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/associated_clusters.html">Searching for Associated TCR/BCR Clusters</a>
    <a class="dropdown-item" href="../articles/buildRepSeqNetwork.html">buildRepSeqNetwork</a>
    <a class="dropdown-item" href="../articles/dual_chain.html">Dual-Chain Network Analysis</a>
    <a class="dropdown-item" href="../articles/network_visualization.html">Network Visualization</a>
    <a class="dropdown-item" href="../articles/public_clusters.html">Searching for Public TCR/BCR Clusters</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1><!-- %%  ~~function to do ... ~~ -->
    Gather Clones in Public Neighborhoods Around Associated Sequences</h1>
      
      <div class="d-none name"><code>findAssociatedClones.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><!-- %%  ~~ A concise (1-5 lines) description of what the function does. ~~ -->
    Given multiple samples of RepSeq data from two groups and a list of receptor
    sequences associated to the comparison group (e.g., obtained using
    <code>findAssociatedSeqs</code>), this function does the following:
    for each associated sequence,
    from all samples that possess the associated sequence, gather the RepSeq data
    for all clones whose receptor sequences lie in a neighborhood of the associated sequence.</p>
<p>The RepSeq data for each neighborhood's associated sequence is then stored in its own data frame
    and saved to its own file, in preparation for use with
    <code>buildAssociatedClusterNetwork</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">findAssociatedClones</span><span class="op">(</span></span>
<span></span>
<span>  <span class="co">## Input ##</span></span>
<span>  <span class="va">file_list</span>, <span class="va">input_type</span>,</span>
<span>  data_symbols <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  header <span class="op">=</span> <span class="cn">TRUE</span>, sep <span class="op">=</span> <span class="st">""</span>,</span>
<span>  sample_ids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">file_list</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  subject_ids <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">group_ids</span>,</span>
<span>  <span class="va">seq_col</span>,</span>
<span></span>
<span>  <span class="co">## Search Criteria ##</span></span>
<span>  <span class="va">assoc_seqs</span>,</span>
<span>  nbd_radius <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  dist_type <span class="op">=</span> <span class="st">"hamming"</span>,</span>
<span>  min_seq_length <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  drop_matches <span class="op">=</span> <span class="st">"[*|_]"</span>,</span>
<span></span>
<span>  <span class="co">## Output ##</span></span>
<span>  subset_cols <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  output_dir <span class="op">=</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"associated_neighborhoods"</span><span class="op">)</span>,</span>
<span>  output_type <span class="op">=</span> <span class="st">"csv"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>file_list</dt>
<dd><p><!-- %%     ~~Describe \code{file_list} here~~ -->
  Passed to <code>loadDataFromFileList</code> (one file per sample).</p></dd>

  <dt>input_type</dt>
<dd><p><!-- %%     ~~Describe \code{input_type} here~~ -->
  Passed to <code>loadDataFromFileList</code>.</p></dd>

  <dt>data_symbols</dt>
<dd><p><!-- %%     ~~Describe \code{data_symbols} here~~ -->
  Passed to <code>loadDataFromFileList</code>.</p></dd>

  <dt>header</dt>
<dd><p><!-- %%     ~~Describe \code{header} here~~ -->
  Passed to <code>loadDataFromFileList</code>.</p></dd>

  <dt>sep</dt>
<dd><p><!-- %%     ~~Describe \code{sep} here~~ -->
  Passed to <code>loadDataFromFileList</code>.</p></dd>

  <dt>sample_ids</dt>
<dd><p><!-- %%     ~~Describe \code{sample_ids} here~~ -->
  A character or numeric vector of sample IDs, whose length matches that of <code>file_list</code>.</p></dd>

  <dt>subject_ids</dt>
<dd><p><!-- %%     ~~Describe \code{subject_ids} here~~ -->
  An optional character or numeric vector of subject IDs, whose length matches that of <code>file_list</code>.</p></dd>

  <dt>group_ids</dt>
<dd><p><!-- %%     ~~Describe \code{group_ids} here~~ -->
  A character or numeric vector of group IDs, which contains exactly two unique
  values and whose length matches that of <code>file_list</code>.</p></dd>

  <dt>seq_col</dt>
<dd><p><!-- %%     ~~Describe \code{seq_col} here~~ -->
    The column name or number of each sample's data frame that contains the receptor sequences to associate with the comparison group.</p></dd>

  <dt>assoc_seqs</dt>
<dd><p><!-- %%     ~~Describe \code{assoc_seqs} here~~ -->
    A character vector containing the receptor sequences associated to the comparison group.</p></dd>

  <dt>nbd_radius</dt>
<dd><p><!-- %%     ~~Describe \code{nbd_radius} here~~ -->
    The maximum distance between an element of <code>assoc_seqs</code> and other clones within its neighborhood.</p></dd>

  <dt>dist_type</dt>
<dd><p><!-- %%     ~~Describe \code{dist_type} here~~ -->
    The distance metric used to measure the distance between sequences in <code>nbd_radius</code>. Valid options are <code>"hamming"</code> and <code>"levenshtein"</code>.</p></dd>

  <dt>min_seq_length</dt>
<dd><p><!-- %%     ~~Describe \code{min_seq_length} here~~ -->
    Passed to <code><a href="filterInputData.html">filterInputData()</a></code> when loading each sample.</p></dd>

  <dt>drop_matches</dt>
<dd><p><!-- %%     ~~Describe \code{drop_matches} here~~ -->
    Passed to <code><a href="filterInputData.html">filterInputData()</a></code>.</p></dd>

  <dt>subset_cols</dt>
<dd><p><!-- %%     ~~Describe \code{subset_cols} here~~ -->
    Passed to <code><a href="filterInputData.html">filterInputData()</a></code>.</p></dd>

  <dt>output_dir</dt>
<dd><p><!-- %%     ~~Describe \code{output_dir} here~~ -->
  The output directory; a valid output directory is required, since results are not returned in R.</p></dd>

  <dt>output_type</dt>
<dd><p><!-- %%     ~~Describe \code{output_dir} here~~ -->
  A character string specifying the file format to use when writing each file. Valid options include <code>"csv"</code>, <code>"tsv"</code>, <code>"rds"</code> and <code>"rda"</code>.</p></dd>

  <dt>verbose</dt>
<dd><p><!-- %%     ~~Describe \code{output_dir} here~~ -->
  A logical scalar; if <code>TRUE</code>, additional console output will be printed reporting the number of clones in each sample belonging to the neighborhood for each associated sequence, as well as the total number of clones in each neighborhood across all samples.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><!-- %%  ~~ If necessary, more details than the description above ~~ -->
   Each neighborhood's RepSeq data file is saved using the corresponding associated sequence
   for the filename, with the appropriate file extension appended based on the
   value of <code>output_type</code> (e.g., the neighborhood data for the sequence
   <code>"CASSGAYEQYF"</code> would be saved as <code>"CASSGAYEQYF.csv"</code> if
   <code>output_type = "csv"</code>).</p>
<p>Three variables, <code>SampleID</code>, <code>SubjectID</code> and <code>GroupID</code>, are added to each neighborhood's RepSeq data, whose respective values in each row are the values of <code>sample_ids</code>, <code>subject_ids</code> and <code>group_ids</code> corresponding to the data in that row.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Hai Yang, Jason Cham, Brian Neal, Zenghua Fan, Tao He and Li Zhang. (2023). NAIR: Network Analysis of Immune Repertoire. <em>Frontiers in Immunology</em>, vol. 14. https://doi.org/10.3389/fimmu.2023.1181825</p>
<p><a href="https://www.frontiersin.org/articles/10.3389/fimmu.2023.1181825" class="external-link">https://www.frontiersin.org/articles/10.3389/fimmu.2023.1181825</a></p>
<p><a href="https://github.com/mlizhangx/Network-Analysis-for-Repertoire-Sequencing-" class="external-link">https://github.com/mlizhangx/Network-Analysis-for-Repertoire-Sequencing-</a></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p><!-- %%  ~~who you are~~ -->
    Brian Neal (<a href="mailto:Brian.Neal@ucsf.edu">Brian.Neal@ucsf.edu</a>)</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><!-- %% ~~objects to See Also as \code{\link{help}}, ~~~ -->
<code><a href="findAssociatedSeqs.html">findAssociatedSeqs</a></code>
<code><a href="buildAssociatedClusterNetwork.html">buildAssociatedClusterNetwork</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co">## Generate some toy data for demonstration</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use temp dir</span></span></span>
<span class="r-in"><span><span class="va">data_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Directory to store input files</span></span></span>
<span class="r-in"><span><span class="va">dir_input_samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">data_dir</span>, <span class="st">"input_samples"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">dir_input_samples</span>, showWarnings <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fl">30</span></span></span>
<span class="r-in"><span><span class="va">affixes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AAAA"</span>, <span class="st">"AASA"</span>, <span class="st">"AACA"</span>, <span class="st">"AAQA"</span>, <span class="st">"AAQ"</span>, <span class="st">"AAA"</span>, <span class="st">"AASAA"</span>, <span class="st">"AAAAA"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">affix_probs_g0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">affixes</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">affixes</span><span class="op">)</span> <span class="op">*</span> <span class="va">samples</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">affix_probs_g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">1</span><span class="op">)</span>, times <span class="op">=</span> <span class="va">samples</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">affix_probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">affix_probs_g0</span>, <span class="va">affix_probs_g1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      nrow <span class="op">=</span> <span class="va">samples</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">new_probs_g0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">6</span><span class="op">)</span>, times <span class="op">=</span> <span class="va">samples</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">new_probs_g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span>, times <span class="op">=</span> <span class="va">samples</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">new_probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">new_probs_g0</span>, <span class="va">new_probs_g1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    nrow <span class="op">=</span> <span class="va">samples</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="simulateToyData.html">simulateToyData</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  samples <span class="op">=</span> <span class="va">samples</span>,</span></span>
<span class="r-in"><span>  sample_size <span class="op">=</span> <span class="fl">30</span>,</span></span>
<span class="r-in"><span>  prefix_length <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  prefix_chars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"C"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  prefix_probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">samples</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">samples</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  affixes <span class="op">=</span> <span class="va">affixes</span>,</span></span>
<span class="r-in"><span>  affix_probs <span class="op">=</span> <span class="va">affix_probs</span>,</span></span>
<span class="r-in"><span>  num_edits <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>  edit_pos_probs <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">seq_length</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">4</span>, length.out <span class="op">=</span> <span class="va">seq_length</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span>,</span></span>
<span class="r-in"><span>  edit_ops <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"insertion"</span>, <span class="st">"deletion"</span>, <span class="st">"transmutation"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  edit_probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  new_chars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"S"</span>, <span class="st">"C"</span>, <span class="st">"Q"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  new_probs <span class="op">=</span> <span class="va">new_probs</span>,</span></span>
<span class="r-in"><span>  output_dir <span class="op">=</span> <span class="va">dir_input_samples</span>,</span></span>
<span class="r-in"><span>  no_return <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## 1. Find Associated Sequences</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># input files for step 1 (one per sample)</span></span></span>
<span class="r-in"><span><span class="va">input_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">dir_input_samples</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Sample"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">samples</span>, <span class="st">".rds"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">input_files</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># group labels for the samples</span></span></span>
<span class="r-in"><span><span class="va">group_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"reference"</span>, <span class="va">samples</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"comparison"</span>, <span class="va">samples</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># search across samples for associated sequences using Fisher's exact test</span></span></span>
<span class="r-in"><span><span class="va">associated_seqs</span> <span class="op">&lt;-</span> <span class="fu"><a href="findAssociatedSeqs.html">findAssociatedSeqs</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  file_list <span class="op">=</span> <span class="va">input_files</span>, input_type <span class="op">=</span> <span class="st">"rds"</span>,</span></span>
<span class="r-in"><span>  group_ids <span class="op">=</span> <span class="va">group_labels</span>, groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"reference"</span>, <span class="st">"comparison"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  min_seq_length <span class="op">=</span> <span class="cn">NULL</span>, drop_matches <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>  seq_col <span class="op">=</span> <span class="st">"CloneSeq"</span>, outfile <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">associated_seqs</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## 2. Find Associated Clones</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># output directory for current step</span></span></span>
<span class="r-in"><span><span class="va">dir_nbds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">data_dir</span>, <span class="st">"assoc_seq_nbds"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Identify neighborhood around each associated sequence</span></span></span>
<span class="r-in"><span><span class="fu">findAssociatedClones</span><span class="op">(</span></span></span>
<span class="r-in"><span>  file_list <span class="op">=</span> <span class="va">input_files</span>, input_type <span class="op">=</span> <span class="st">"rds"</span>, group_ids <span class="op">=</span> <span class="va">group_labels</span>,</span></span>
<span class="r-in"><span>  seq_col <span class="op">=</span> <span class="st">"CloneSeq"</span>, dist_type <span class="op">=</span> <span class="st">"levenshtein"</span>,</span></span>
<span class="r-in"><span>  assoc_seqs <span class="op">=</span> <span class="va">associated_seqs</span><span class="op">$</span><span class="va">ReceptorSeq</span>,</span></span>
<span class="r-in"><span>  min_seq_length <span class="op">=</span> <span class="cn">NULL</span>, drop_matches <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>  output_dir <span class="op">=</span> <span class="va">dir_nbds</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Brian Neal, Hai Yang, Phi Long Le, Li Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

