<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="
    Given cluster-level meta data for each sample's filtered public clusters,
    combine the data across samples and perform network analysis using a
    representative sequence from each cluster."><title>
    Build Public Cluster Network By Representative — buildPublicClusterNetworkByRepresentative • NAIR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="
    Build Public Cluster Network By Representative — buildPublicClusterNetworkByRepresentative"><meta property="og:description" content="
    Given cluster-level meta data for each sample's filtered public clusters,
    combine the data across samples and perform network analysis using a
    representative sequence from each cluster."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">NAIR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.9041</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/NAIR.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/associated_clusters.html">Searching for Associated TCR/BCR Clusters</a>
    <a class="dropdown-item" href="../articles/buildRepSeqNetwork.html">buildRepSeqNetwork</a>
    <a class="dropdown-item" href="../articles/dual_chain.html">Dual-Chain Network Analysis</a>
    <a class="dropdown-item" href="../articles/network_visualization.html">Network Visualization</a>
    <a class="dropdown-item" href="../articles/public_clusters.html">Searching for Public TCR/BCR Clusters</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1><!-- %%  ~~function to do ... ~~ -->
    Build Public Cluster Network By Representative</h1>
      
      <div class="d-none name"><code>buildPublicClusterNetworkByRepresentative.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><!-- %%  ~~ A concise (1-5 lines) description of what the function does. ~~ -->
    Given cluster-level meta data for each sample's filtered public clusters,
    combine the data across samples and perform network analysis using a
    representative sequence from each cluster.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">buildPublicClusterNetworkByRepresentative</span><span class="op">(</span></span>
<span></span>
<span>  <span class="co">## Input ##</span></span>
<span>  <span class="va">file_list</span>,</span>
<span>  input_type <span class="op">=</span> <span class="st">"rds"</span>, data_symbols <span class="op">=</span> <span class="st">"cdat"</span>,</span>
<span>  header <span class="op">=</span> <span class="cn">TRUE</span>, sep <span class="op">=</span> <span class="st">""</span>,</span>
<span>  seq_col <span class="op">=</span> <span class="st">"seq_w_max_count"</span>,</span>
<span>  count_col <span class="op">=</span> <span class="st">"agg_count"</span>,</span>
<span></span>
<span>  <span class="co">## Network ##</span></span>
<span>  dist_type <span class="op">=</span> <span class="st">"hamming"</span>,</span>
<span>  dist_cutoff <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  cluster_fun <span class="op">=</span> <span class="va">cluster_fast_greedy</span>,</span>
<span></span>
<span>  <span class="co">## Visualization ##</span></span>
<span>  plots <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  print_plots <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_title <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  plot_subtitle <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  color_nodes_by <span class="op">=</span> <span class="st">"SampleID"</span>,</span>
<span>  color_scheme <span class="op">=</span> <span class="st">"turbo"</span>,</span>
<span>  <span class="va">...</span>,</span>
<span></span>
<span>  <span class="co">## Output ##</span></span>
<span>  output_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"public_clusters"</span><span class="op">)</span>,</span>
<span>  output_type <span class="op">=</span> <span class="st">"rda"</span>,</span>
<span>  output_name <span class="op">=</span> <span class="st">"PubClustByRepresentative"</span>,</span>
<span>  pdf_width <span class="op">=</span> <span class="fl">12</span>, pdf_height <span class="op">=</span> <span class="fl">10</span></span>
<span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>file_list</dt>
<dd><p><!-- %%     ~~Describe \code{file_list} here~~ -->
  Passed to <code>loadDataFromFileList</code> when loading the cluster-level meta data
  for each sample (one data frame per sample). Data frames should match the
  format of the cluster-level meta data returned by <code>buildRepSeqNetwork</code>.</p></dd>

  <dt>input_type</dt>
<dd><p><!-- %%     ~~Describe \code{input_type} here~~ -->
  Passed to <code>loadDataFromFileList</code>.</p></dd>

  <dt>data_symbols</dt>
<dd><p><!-- %%     ~~Describe \code{data_symbols} here~~ -->
  Passed to <code>loadDataFromFileList</code>.</p></dd>

  <dt>header</dt>
<dd><p><!-- %%     ~~Describe \code{header} here~~ -->
  Passed to <code>loadDataFromFileList</code>.</p></dd>

  <dt>sep</dt>
<dd><p><!-- %%     ~~Describe \code{sep} here~~ -->
  Passed to <code>loadDataFromFileList</code>.</p></dd>

  <dt>seq_col</dt>
<dd><p><!-- %%     ~~Describe \code{seq_col} here~~ -->
    The column name or number of each data frame that contains the representative sequence to be used as the basis of similarity between rows during network analysis. This column must have the same name in each sample.</p></dd>

  <dt>count_col</dt>
<dd><p><!-- %%     ~~Describe \code{count_col} here~~ -->
    Passed to <code>buildRepSeqNetwork</code>.</p></dd>

  <dt>dist_type</dt>
<dd><p><!-- %%     ~~Describe \code{dist_type} here~~ -->
    Passed to <code>buildRepSeqNetwork</code>.</p></dd>

  <dt>dist_cutoff</dt>
<dd><p><!-- %%     ~~Describe \code{dist_cutoff} here~~ -->
    Passed to <code>buildRepSeqNetwork</code>.</p></dd>

  <dt>cluster_fun</dt>
<dd><p><!-- %%     ~~Describe \code{net} here~~ -->
    Passed to <code>addClusterMembership</code>. Controls the algorithm used for cluster identification.</p></dd>

  <dt>plots</dt>
<dd><p><!-- %%     ~~Describe \code{plots} here~~ -->
    Passed to <code>buildRepSeqNetwork</code>.</p></dd>

  <dt>print_plots</dt>
<dd><p><!-- %%     ~~Describe \code{print_plots} here~~ -->
    Passed to <code>buildRepSeqNetwork</code>.</p></dd>

  <dt>plot_title</dt>
<dd><p><!-- %%     ~~Describe \code{plot_title} here~~ -->
    Passed to <code>buildRepSeqNetwork</code>.</p></dd>

  <dt>plot_subtitle</dt>
<dd><p><!-- %%     ~~Describe \code{plot_subtitle} here~~ -->
    Passed to <code>buildRepSeqNetwork</code>.</p></dd>

  <dt>color_nodes_by</dt>
<dd><p><!-- %%     ~~Describe \code{color_nodes_by} here~~ -->
    Passed to <code>generateNetworkGraphPlots</code>.</p></dd>

  <dt>color_scheme</dt>
<dd><p><!-- %%     ~~Describe \code{color_scheme} here~~ -->
    Passed to <code>generateNetworkGraphPlots</code>.</p></dd>

  <dt>...</dt>
<dd><p><!-- %%     ~~Describe \code{\dots} here~~ -->
    Other arguments to <code>generateNetworkGraphPlots</code>.</p></dd>

  <dt>output_dir</dt>
<dd><p><!-- %%     ~~Describe \code{output_dir} here~~ -->
    Passed to <code>saveNetwork</code>.</p></dd>

  <dt>output_type</dt>
<dd><p><!-- %%     ~~Describe \code{output_type} here~~ -->
    Passed to <code>saveNetwork</code>.</p></dd>

  <dt>output_name</dt>
<dd><p><!-- %%     ~~Describe \code{output_name} here~~ -->
    Passed to <code>saveNetwork</code>.</p></dd>

  <dt>pdf_width</dt>
<dd><p><!-- %%     ~~Describe \code{pdf_width} here~~ -->
    Passed to <code>saveNetwork</code>.</p></dd>

  <dt>pdf_height</dt>
<dd><p><!-- %%     ~~Describe \code{pdf_height} here~~ -->
    Passed to <code>saveNetwork</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><!-- %%  ~~ If necessary, more details than the description above ~~ --></p>
<p>This function is intended for performing network analysis on the public clusters
    obtained using <code><a href="findPublicClusters.html">findPublicClusters()</a></code>.</p>
<p>By using the cluster-level meta data as the input to <code><a href="buildRepSeqNetwork.html">buildRepSeqNetwork()</a></code>,
    this function treats each public cluster as a single node and performs network
    analysis with similarity based on a representative sequence for each cluster
    (e.g., the sequence with the greatest clone count). <code>buildRepSeqNetwork</code> is
    called without any filtering and with <code>drop_isolated_nodes = FALSE</code>.</p>
<p>All node-level properties are automatically computed for the network, and
    cluster-level properties for the network (in which clusters of nodes represent
    clusters of public-cluster-representatives) are computed based on the properties
    of the public cluster represented by each node. See the 'value' section for a list and      description of each property.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><!-- %%  ~Describe the value returned --></p>


<p><!-- %%  If it is a LIST, use --></p>


<p><!-- %%  \item{comp1 }{Description of 'comp1'} --></p>


<p><!-- %%  \item{comp2 }{Description of 'comp2'} --></p>


<p><!-- %% ... --></p>


<p>A list of network objects as per <code><a href="buildRepSeqNetwork.html">buildRepSeqNetwork()</a></code>. The data frame</p>
<p></p>
<p><code>cluster_data</code> includes the following variables:</p>
<dl><dt>TotalSampleLevelNodes</dt>
<dd><p>Each network node in the cluster for the current row represents
        a public cluster; this value is the sum of the sample-network-level nodes
        contained in all such public clusters for the current row.</p></dd>

    <dt>TotalCloneCount</dt>
<dd><p>Each network node in the cluster for the current row represents
        a public cluster; this value is the sum of the aggregate clone count
        across all such public clusters for the current row.</p></dd>

    <dt>MeanOfMeanSeqLength</dt>
<dd><p>Each network node in the cluster for the current row represents
        a public cluster; this value is the mean value of the mean sequence length
        across all such public clusters for the current row.</p></dd>

    <dt>MeanDegreeInPublicNet</dt>
<dd><p>The mean network degree of all the network nodes in the cluster for
        the current row.</p></dd>

    <dt>MaxDegreeInPublicNet</dt>
<dd><p>The maximum network degree of all the network nodes in the cluster for
        the current row.</p></dd>

    <dt>SeqWithMaxDegree</dt>
<dd><p>The representative sequence of the network node with maximum network degree
        of all the network nodes in the cluster for the current row. If more than
        one node attains the maximum network degree, the first sequence found is
        returned.</p></dd>

    <dt>MaxCloneCount</dt>
<dd><p>Each network node in the cluster for the current row represents
        a public cluster; this is the maximum value of the
        maximum clone count property across all such public clusters for the
        current row.</p></dd>

    <dt>SampleWithMaxCloneCount</dt>
<dd><p>The sample possessing the public cluster with the maximum value
        of the maximum clone count property across all the public clusters
        represented by the network nodes in the cluster for the current row.
        If more than one public cluster attains the maximum value, the first
        sample ID found is returned.</p></dd>

    <dt>SeqWithMaxCloneCount</dt>
<dd><p>The representative sequence of the public cluster with the maximum value
        of the maximum clone count property across all the public clusters
        represented by the network nodes in the cluster for the current row.
        If more than one public cluster attains the maximum value, the first
        sequence found is returned.</p></dd>

    <dt>MaxAggCloneCount</dt>
<dd><p>Each network node in the cluster for the current row represents
        a public cluster; this is the maximum value of the
        aggregate clone count property across all such public clusters for the
        current row.</p></dd>

    <dt>SampleWithMaxAggCloneCount</dt>
<dd><p>The sample possessing the public cluster with the maximum value
        of the aggregate clone count property across all the public clusters
        represented by the network nodes in the cluster for the current row.
        If more than one public cluster attains the maximum value, the first
        sample ID found is returned.</p></dd>

    <dt>SeqWithMaxAggCloneCount</dt>
<dd><p>The representative sequence of the public cluster with the maximum value
        of the aggregate clone count property across all the public clusters
        represented by the network nodes in the cluster for the current row.
        If more than one public cluster attains the maximum value, the first
        sequence found is returned.</p></dd>

    <dt>DiameterLength</dt>
<dd><p>See <code>?getClusterStats()</code>.</p></dd>

    <dt>Assortativity</dt>
<dd><p>See <code>?getClusterStats()</code>.</p></dd>

    <dt>GlobalTransitivity</dt>
<dd><p>See <code>?getClusterStats()</code>.</p></dd>

    <dt>EdgeDensity</dt>
<dd><p>See <code>?getClusterStats()</code>.</p></dd>

    <dt>DegreeCentralityIndex</dt>
<dd><p>See <code>?getClusterStats()</code>.</p></dd>

    <dt>ClosenessCentralityIndex</dt>
<dd><p>See <code>?getClusterStats()</code>.</p></dd>

    <dt>EigenCentralityIndex</dt>
<dd><p>See <code>?getClusterStats()</code>.</p></dd>

    <dt>EigenCentralityEigenvalue</dt>
<dd><p>See <code>?getClusterStats()</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Hai Yang, Jason Cham, Brian Neal, Zenghua Fan, Tao He and Li Zhang. (2023). NAIR: Network Analysis of Immune Repertoire. <em>Frontiers in Immunology</em>, vol. 14. https://doi.org/10.3389/fimmu.2023.1181825</p>
<p><a href="https://www.frontiersin.org/articles/10.3389/fimmu.2023.1181825" class="external-link">https://www.frontiersin.org/articles/10.3389/fimmu.2023.1181825</a></p>
<p><a href="https://github.com/mlizhangx/Network-Analysis-for-Repertoire-Sequencing-" class="external-link">https://github.com/mlizhangx/Network-Analysis-for-Repertoire-Sequencing-</a></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p><!-- %%  ~~who you are~~ -->
    Brian Neal (<a href="mailto:Brian.Neal@ucsf.edu">Brian.Neal@ucsf.edu</a>)</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><!-- %% ~~objects to See Also as \code{\link{help}}, ~~~ -->
<code><a href="findPublicClusters.html">findPublicClusters</a></code>
<code><a href="buildPublicClusterNetwork.html">buildPublicClusterNetwork</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co">## Generate some toy data for demonstration</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use temp dir</span></span></span>
<span class="r-in"><span><span class="va">data_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Directory to store input files</span></span></span>
<span class="r-in"><span><span class="va">dir_input_samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">data_dir</span>, <span class="st">"input_samples"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">dir_input_samples</span>, showWarnings <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fl">30</span></span></span>
<span class="r-in"><span><span class="va">affixes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AAAA"</span>, <span class="st">"AASA"</span>, <span class="st">"AACA"</span>, <span class="st">"AAQA"</span>, <span class="st">"AAQ"</span>, <span class="st">"AAA"</span>, <span class="st">"AASAA"</span>, <span class="st">"AAAAA"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">affix_probs_g0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">affixes</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">affixes</span><span class="op">)</span> <span class="op">*</span> <span class="va">samples</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">affix_probs_g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">1</span><span class="op">)</span>, times <span class="op">=</span> <span class="va">samples</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">affix_probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">affix_probs_g0</span>, <span class="va">affix_probs_g1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      nrow <span class="op">=</span> <span class="va">samples</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">new_probs_g0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">6</span><span class="op">)</span>, times <span class="op">=</span> <span class="va">samples</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">new_probs_g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span>, times <span class="op">=</span> <span class="va">samples</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">new_probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">new_probs_g0</span>, <span class="va">new_probs_g1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    nrow <span class="op">=</span> <span class="va">samples</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="simulateToyData.html">simulateToyData</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  samples <span class="op">=</span> <span class="va">samples</span>,</span></span>
<span class="r-in"><span>  sample_size <span class="op">=</span> <span class="fl">30</span>,</span></span>
<span class="r-in"><span>  prefix_length <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  prefix_chars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"C"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  prefix_probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">samples</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">samples</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  affixes <span class="op">=</span> <span class="va">affixes</span>,</span></span>
<span class="r-in"><span>  affix_probs <span class="op">=</span> <span class="va">affix_probs</span>,</span></span>
<span class="r-in"><span>  num_edits <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>  edit_pos_probs <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">seq_length</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">4</span>, length.out <span class="op">=</span> <span class="va">seq_length</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span>,</span></span>
<span class="r-in"><span>  edit_ops <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"insertion"</span>, <span class="st">"deletion"</span>, <span class="st">"transmutation"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  edit_probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  new_chars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"S"</span>, <span class="st">"C"</span>, <span class="st">"Q"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  new_probs <span class="op">=</span> <span class="va">new_probs</span>,</span></span>
<span class="r-in"><span>  output_dir <span class="op">=</span> <span class="va">dir_input_samples</span>,</span></span>
<span class="r-in"><span>  no_return <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## 1. Find Public Clusters in Each Sample</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># input files for step 1 (one per sample)</span></span></span>
<span class="r-in"><span><span class="va">input_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">dir_input_samples</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Sample"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">samples</span>, <span class="st">".rds"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">input_files</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Search across samples for public clusters</span></span></span>
<span class="r-in"><span><span class="va">dir_filtered_samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">data_dir</span>, <span class="st">"filtered_samples"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="findPublicClusters.html">findPublicClusters</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  file_list <span class="op">=</span> <span class="va">input_files</span>, input_type <span class="op">=</span> <span class="st">"rds"</span>,</span></span>
<span class="r-in"><span>  sample_ids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Sample"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">samples</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  seq_col <span class="op">=</span> <span class="st">"CloneSeq"</span>, count_col <span class="op">=</span> <span class="st">"CloneCount"</span>,</span></span>
<span class="r-in"><span>  min_seq_length <span class="op">=</span> <span class="cn">NULL</span>, drop_matches <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>  output_dir <span class="op">=</span> <span class="va">dir_filtered_samples</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## 2. Build Public Cluster Network by Representative Sequence</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Cluster-level meta data for each sample's public clusters</span></span></span>
<span class="r-in"><span><span class="va">dir_filtered_samples_cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">dir_filtered_samples</span>, <span class="st">"cluster_meta_data"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">files_filtered_samples_cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">dir_filtered_samples_cluster</span>,</span></span>
<span class="r-in"><span>                                             full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">files_filtered_samples_cluster</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dir_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">data_dir</span>, <span class="st">"public_clusters"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">buildPublicClusterNetworkByRepresentative</span><span class="op">(</span></span></span>
<span class="r-in"><span>  file_list <span class="op">=</span> <span class="va">files_filtered_samples_cluster</span>,</span></span>
<span class="r-in"><span>  color_nodes_by <span class="op">=</span> <span class="st">"ClusterIDPublic"</span>, output_dir <span class="op">=</span> <span class="va">dir_out</span>,</span></span>
<span class="r-in"><span>  size_nodes_by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Brian Neal, Hai Yang, Phi Long Le, Li Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

