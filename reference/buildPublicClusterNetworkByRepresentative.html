<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Alternative step in the workflow
Searching for Public TCR/BCR Clusters.
Intended for use following findPublicClusters()
in cases where
buildPublicClusterNetwork()
cannot be practically used due to the size of the full global network.
Given cluster-level metadata for each sample's filtered clusters, selects a
representative TCR/BCR from each cluster, combines the representatives into a
global network and performs network analysis and cluster analysis."><title>Build Global Network of Public TCR/BCR Clusters Using Representative Clones — buildPublicClusterNetworkByRepresentative • NAIR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Build Global Network of Public TCR/BCR Clusters Using Representative Clones — buildPublicClusterNetworkByRepresentative"><meta property="og:description" content="Alternative step in the workflow
Searching for Public TCR/BCR Clusters.
Intended for use following findPublicClusters()
in cases where
buildPublicClusterNetwork()
cannot be practically used due to the size of the full global network.
Given cluster-level metadata for each sample's filtered clusters, selects a
representative TCR/BCR from each cluster, combines the representatives into a
global network and performs network analysis and cluster analysis."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">NAIR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/NAIR.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/buildRepSeqNetwork.html">buildRepSeqNetwork()/buildNet()</a>
    <a class="dropdown-item" href="../articles/node_properties.html">Node-Level Network Properties</a>
    <a class="dropdown-item" href="../articles/cluster_analysis.html">Cluster Analysis</a>
    <a class="dropdown-item" href="../articles/network_visualization.html">Network Visualization</a>
    <a class="dropdown-item" href="../articles/supplementary.html">Supplementary Functions</a>
    <a class="dropdown-item" href="../articles/dual_chain.html">Dual-Chain Network Analysis</a>
    <a class="dropdown-item" href="../articles/associated_clusters.html">Searching for Associated TCR/BCR Clusters</a>
    <a class="dropdown-item" href="../articles/public_clusters.html">Searching for Public TCR/BCR Clusters</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mlizhangx/Network-Analysis-for-Repertoire-Sequencing-/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Build Global Network of Public TCR/BCR Clusters Using Representative Clones</h1>
      
      <div class="d-none name"><code>buildPublicClusterNetworkByRepresentative.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Alternative step in the workflow
<a href="https://mlizhangx.github.io/Network-Analysis-for-Repertoire-Sequencing-/articles/public_clusters.html">Searching for Public TCR/BCR Clusters</a>.
Intended for use following <code><a href="findPublicClusters.html">findPublicClusters()</a></code>
in cases where
<code><a href="buildPublicClusterNetwork.html">buildPublicClusterNetwork()</a></code>
cannot be practically used due to the size of the full global network.</p>
<p>Given cluster-level metadata for each sample's filtered clusters, selects a
representative TCR/BCR from each cluster, combines the representatives into a
global network and performs network analysis and cluster analysis.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">buildPublicClusterNetworkByRepresentative</span><span class="op">(</span></span>
<span></span>
<span>  <span class="co">## Input ##</span></span>
<span>  <span class="va">file_list</span>,</span>
<span>  input_type <span class="op">=</span> <span class="st">"rds"</span>,</span>
<span>  data_symbols <span class="op">=</span> <span class="st">"cdat"</span>,</span>
<span>  <span class="va">header</span>, <span class="va">sep</span>, <span class="va">read.args</span>,</span>
<span>  seq_col <span class="op">=</span> <span class="st">"seq_w_max_count"</span>,</span>
<span>  count_col <span class="op">=</span> <span class="st">"agg_count"</span>,</span>
<span></span>
<span>  <span class="co">## Network Settings ##</span></span>
<span>  dist_type <span class="op">=</span> <span class="st">"hamming"</span>,</span>
<span>  dist_cutoff <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  cluster_fun <span class="op">=</span> <span class="st">"fast_greedy"</span>,</span>
<span></span>
<span>  <span class="co">## Visualization ##</span></span>
<span>  plots <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  print_plots <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  plot_title <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  plot_subtitle <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  color_nodes_by <span class="op">=</span> <span class="st">"SampleID"</span>,</span>
<span>  color_scheme <span class="op">=</span> <span class="st">"turbo"</span>,</span>
<span>  <span class="va">...</span>,</span>
<span></span>
<span>  <span class="co">## Output ##</span></span>
<span>  output_dir <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  output_type <span class="op">=</span> <span class="st">"rds"</span>,</span>
<span>  output_name <span class="op">=</span> <span class="st">"PubClustByRepresentative"</span>,</span>
<span>  pdf_width <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  pdf_height <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>file_list</dt>
<dd><p>A vector of file paths where each file contains the cluster-level metadata for
  one sample's filtered clusters.
  Passed to <code><a href="combineSamples.html">loadDataFromFileList()</a></code>.</p></dd>

  <dt>input_type</dt>
<dd><p>A character string specifying the file format of the input files. Options are
  <code>"csv"</code>, <code>"rds"</code> and <code>"rda"</code>. Passed to
  <code><a href="combineSamples.html">loadDataFromFileList()</a></code>.</p></dd>

  <dt>data_symbols</dt>
<dd><p>Used when <code>input_type = "rda"</code>. Specifies the name of the data frame
  within each Rdata file.
  Passed to <code><a href="combineSamples.html">loadDataFromFileList()</a></code>.</p></dd>

  <dt>header</dt>
<dd><p>For values of <code>input_type</code> other than <code>"rds"</code> and <code>"rda"</code>,
    this argument can be used to specify a non-default value of the <code>header</code>
    argument to <code><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table()</a></code>,
    <code><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv()</a></code>, etc.</p></dd>

  <dt>sep</dt>
<dd><p>For values of <code>input_type</code> other than <code>"rds"</code> and <code>"rda"</code>,
    this argument can be used to specify a non-default value of the <code>sep</code>
    argument to <code><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table()</a></code>,
    <code><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv()</a></code>, etc.</p></dd>

  <dt>read.args</dt>
<dd><p>For values of <code>input_type</code> other than <code>"rds"</code> and <code>"rda"</code>,
    this argument can be used to specify non-default values of optional
    arguments to <code><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table()</a></code>,
    <code><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv()</a></code>, etc.
    Accepts a named list of argument values.
    Values of <code>header</code> and <code>sep</code>
    in this list take precedence over values specified via the <code>header</code>
    and <code>sep</code> arguments.</p></dd>

  <dt>seq_col</dt>
<dd><p>Specifies the column in the cluster-level metadata that contains the
    representative TCR/BCR sequence for each cluster.
    Accepts a character string containing the column name
      or a numeric scalar containing the column index.
    By default, uses the sequence with the maximum clone
    count in each cluster.</p></dd>

  <dt>count_col</dt>
<dd><p>Specifies the column in the cluster-level metadata that contains the aggregate
    clone count for each cluster.
    Accepts a character string containing the column name
      or a numeric scalar containing the column index.</p></dd>

  <dt>dist_type</dt>
<dd><p>Passed to <code><a href="buildRepSeqNetwork.html">buildRepSeqNetwork()</a></code>
    when constructing the global network.</p></dd>

  <dt>dist_cutoff</dt>
<dd><p>Passed to <code><a href="buildRepSeqNetwork.html">buildRepSeqNetwork()</a></code>
    when constructing the global network.</p></dd>

  <dt>cluster_fun</dt>
<dd><p>Passed to <code><a href="buildRepSeqNetwork.html">buildRepSeqNetwork()</a></code>
    when performing cluster analysis on the global network.</p></dd>

  <dt>plots</dt>
<dd><p>Logical. Should plots of the global network graph be produced?</p></dd>

  <dt>print_plots</dt>
<dd><p>Logical. If plots of the global network graph are produced, should they be
    printed to the R plotting window?</p></dd>

  <dt>plot_title</dt>
<dd><p>Passed to <code><a href="addPlots.html">addPlots()</a></code> when producing plots of the
    global network graph.</p></dd>

  <dt>plot_subtitle</dt>
<dd><p>Passed to <code><a href="addPlots.html">addPlots()</a></code> when producing plots of the
    global network graph.</p></dd>

  <dt>color_nodes_by</dt>
<dd><p>Passed to <code><a href="addPlots.html">addPlots()</a></code> when producing plots of the
    global network graph. Valid options include the default <code>"SampleID"</code>,
    as well as node-level properties (see <code><a href="addNodeNetworkStats.html">addNodeNetworkStats</a></code>) and
    sample-level cluster properties (see <code><a href="getClusterStats.html">getClusterStats</a></code>), which
    correspond to the representative TCRs/BCRs and the original sample-level clusters
    they represent, respectively.</p></dd>

  <dt>color_scheme</dt>
<dd><p>Passed to <code><a href="addPlots.html">addPlots()</a></code> when producing plots of the
    global network graph.</p></dd>

  <dt>...</dt>
<dd><p>Other arguments to <code><a href="addPlots.html">addPlots()</a></code> when producing plots
    of the global network graph.</p></dd>

  <dt>output_dir</dt>
<dd><p>Passed to <code><a href="saveNetwork.html">saveNetwork()</a></code> after constructing the global network.</p></dd>

  <dt>output_type</dt>
<dd><p>Passed to <code><a href="saveNetwork.html">saveNetwork()</a></code> after constructing the global network.</p></dd>

  <dt>output_name</dt>
<dd><p>Passed to <code><a href="saveNetwork.html">saveNetwork()</a></code> after constructing the global network.</p></dd>

  <dt>pdf_width</dt>
<dd><p>Passed to <code><a href="saveNetwork.html">saveNetwork()</a></code> after constructing the global network.
    Only applicable if <code>plots = TRUE</code>.</p></dd>

  <dt>pdf_height</dt>
<dd><p>Passed to <code><a href="saveNetwork.html">saveNetwork()</a></code> after constructing the global network.
    Only applicable if <code>plots = TRUE</code>.</p></dd>

  <dt>verbose</dt>
<dd><p>Logical. If <code>TRUE</code>, generates messages about the tasks
      performed and their progress, as well as relevant properties of intermediate
      outputs. Messages are sent to <code><a href="https://rdrr.io/r/base/showConnections.html" class="external-link">stderr()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>From each filtered cluster in each sample's network, a representative TCR/BCR
is selected. By default, this is the sequence with the greatest clone count in
each cluster. The representatives from all clusters and all samples are then
used to construct a single global network. Cluster analysis is used to partition
this global network into clusters. Network properties for the nodes and clusters
are computed and returned as metadata. A plot of the global network graph is
produced, with the nodes colored according to sample ID.</p>
<p>Within this network, clusters containing nodes from multiple samples can be
considered as the skeletons of the complete public clusters. The filtered cluster
data for each sample can then be subset to keep the sample-level clusters whose
representative TCR/BCRs belong to the skeletons of the public clusters. After
subsetting in this manner,
<code><a href="buildPublicClusterNetwork.html">buildPublicClusterNetwork()</a></code> can be used
to construct the global network of complete public clusters.</p>
<p>See the
<a href="https://mlizhangx.github.io/Network-Analysis-for-Repertoire-Sequencing-/articles/public_clusters.html">Searching for Public TCR/BCR Clusters</a>
article on the package website.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>If the input data contains a combined total of fewer than two rows, or if the
    global network contains no nodes, then the function returns <code>NULL</code>,
    invisibly, with a warning. Otherwise, invisibly returns
    a list of network objects as returned by</p>
<p></p>
<p><code><a href="buildRepSeqNetwork.html">buildRepSeqNetwork()</a></code>.
    The global cluster membership variable in the data frame <code>node_data</code></p>


<p>is named <code>ClusterIDPublic</code>.</p>


<p>The data frame <code>cluster_data</code> includes the following variables that
    represent properties of the clusters in the global network of representative
    TCR/BCRs:</p>
<dl><dt>cluster_id</dt>
<dd><p>The global cluster ID number.</p></dd>

<dt>node_count</dt>
<dd><p>The number of global network nodes in the global cluster.</p></dd>

<dt>TotalSampleLevelNodes</dt>
<dd><p>For each representative TCR/BCR in the global cluster, we record the number
    of nodes in the sample-level cluster for which it is the representative TCR/BCR.
    We then sum these node counts across all the representative TCR/BCRs in the
    global cluster.</p></dd>

<dt>TotalCloneCount</dt>
<dd><p>For each representative TCR/BCR in the global cluster, we record the
    aggregate clone count from all nodes in the sample-level cluster for which
    it is the representative TCR/BCR. We then sum these aggregate clone counts
    across all the representative TCR/BCRs in the global cluster.</p></dd>

<dt>MeanOfMeanSeqLength</dt>
<dd><p>For each representative TCR/BCR in the global cluster, we record the mean
    sequence length over all clones (nodes) in the sample-level cluster for which
    it is the representative TCR/BCR. We then average these mean sequence lengths
    over all the representative TCR/BCRs in the global cluster.</p></dd>

<dt>MeanDegreeInPublicNet</dt>
<dd><p>For each representative TCR/BCR in the global cluster, we record the mean
    network degree over all nodes in the sample-level cluster for which it is the
    representative TCR/BCR. We then average these mean degree values over all the
    representative TCR/BCRs in the global cluster.</p></dd>

<dt>MaxDegreeInPublicNet</dt>
<dd><p>For each representative TCR/BCR in the global cluster, we record the maximum
    network degree across all nodes in the sample-level cluster for which it is
    the representative TCR/BCR. We then take the maximum of these maximum degree
    values over all the representative TCR/BCRs in the global cluster.</p></dd>

<dt>SeqWithMaxDegree</dt>
<dd><p>For each representative TCR/BCR in the global cluster, we record the maximum
    network degree across all nodes in the sample-level cluster for which it is
    the representative TCR/BCR. We then identify the representative TCR/BCR with
    the maximum value of these maximum degrees over all the representative TCR/BCRs
    in the global cluster. The TCR/BCR sequence of the identified representative
    TCR/BCR is recorded in this variable.</p></dd>

<dt>MaxCloneCount</dt>
<dd><p>For each representative TCR/BCR in the global cluster, we record the maximum
    clone count across all clones (nodes) in the sample-level cluster for which
    it is the representative TCR/BCR. We then take the maximum of these maximum
    clone counts over all the representative TCR/BCRs in the global cluster.</p></dd>

<dt>SampleWithMaxCloneCount</dt>
<dd><p>For each representative TCR/BCR in the global cluster, we record the maximum
    clone count across all clones (nodes) in the sample-level cluster for which
    it is the representative TCR/BCR. We then identify the representative TCR/BCR
    with the maximum value of these maximum clone counts over all the representative
    TCR/BCRs in the global cluster. The sample to which the identified representative
    TCR/BCR belongs is recorded in this variable.</p></dd>

<dt>SeqWithMaxCloneCount</dt>
<dd><p>For each representative TCR/BCR in the global cluster, we record the maximum
    clone count across all clones (nodes) in the sample-level cluster for which it
    is the representative TCR/BCR. We then identify the representative TCR/BCR with
    the maximum value of these maximum clone counts over all the representative
    TCR/BCRs in the global cluster. The TCR/BCR sequence of the identified
    representative TCR/BCR is recorded in this variable.</p></dd>

<dt>MaxAggCloneCount</dt>
<dd><p>For each representative TCR/BCR in the global cluster, we record the
    aggregate clone count across all clones (nodes) in the sample-level cluster
    for which it is the representative TCR/BCR. We then take the maximum of these
    aggregate clone counts over all the representative TCR/BCRs in the global
    cluster.</p></dd>

<dt>SampleWithMaxAggCloneCount</dt>
<dd><p>For each representative TCR/BCR in the global cluster, we record the
    aggregate clone count across all clones (nodes) in the sample-level cluster
    for which it is the representative TCR/BCR. We then identify the representative
    TCR/BCR with the maximum value of these aggregate clone counts over all the
    representative TCR/BCRs in the global cluster. The sample to which the
    identified representative TCR/BCR belongs is recorded in this variable.</p></dd>

<dt>SeqWithMaxAggCloneCount</dt>
<dd><p>For each representative TCR/BCR in the global cluster, we record the
    aggregate clone count across all clones (nodes) in the sample-level cluster
    for which it is the representative TCR/BCR. We then identify the representative
    TCR/BCR with the maximum value of these aggregate clone counts over all the
    representative TCR/BCRs in the global cluster. The TCR/BCR sequence of the
    identified representative TCR/BCR is recorded in this variable.</p></dd>

<dt>DiameterLength</dt>
<dd><p>See <code><a href="getClusterStats.html">getClusterStats</a></code>.
    Based on edge connections between representative TCR/BCRs in the global cluster.</p></dd>

<dt>Assortativity</dt>
<dd><p>See <code><a href="getClusterStats.html">getClusterStats</a></code>.
    Based on edge connections between representative TCR/BCRs in the global cluster.</p></dd>

<dt>GlobalTransitivity</dt>
<dd><p>See <code><a href="getClusterStats.html">getClusterStats</a></code>.
    Based on edge connections between representative TCR/BCRs in the global cluster.</p></dd>

<dt>EdgeDensity</dt>
<dd><p>See <code><a href="getClusterStats.html">getClusterStats</a></code>.
    Based on edge connections between representative TCR/BCRs in the global cluster.</p></dd>

<dt>DegreeCentralityIndex</dt>
<dd><p>See <code><a href="getClusterStats.html">getClusterStats</a></code>.
    Based on edge connections between representative TCR/BCRs in the global cluster.</p></dd>

<dt>ClosenessCentralityIndex</dt>
<dd><p>See <code><a href="getClusterStats.html">getClusterStats</a></code>.
  Based on edge connections between representative TCR/BCRs in the global cluster.</p></dd>

<dt>EigenCentralityIndex</dt>
<dd><p>See <code><a href="getClusterStats.html">getClusterStats</a></code>.
    Based on edge connections between representative TCR/BCRs in the global cluster.</p></dd>

<dt>EigenCentralityEigenvalue</dt>
<dd><p>See <code><a href="getClusterStats.html">getClusterStats</a></code>.
    Based on edge connections between representative TCR/BCRs in the global cluster.</p></dd>



</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Hai Yang, Jason Cham, Brian Neal, Zenghua Fan, Tao He and Li Zhang. (2023).
NAIR: Network Analysis of Immune Repertoire. <em>Frontiers in Immunology</em>, vol. 14.
<a href="https://www.frontiersin.org/articles/10.3389/fimmu.2023.1181825/full" class="external-link">doi: 10.3389/fimmu.2023.1181825</a></p>
<p><a href="https://mlizhangx.github.io/Network-Analysis-for-Repertoire-Sequencing-/index.html">Webpage for the NAIR package</a></p>
<p><a href="https://mlizhangx.github.io/Network-Analysis-for-Repertoire-Sequencing-/articles/public_clusters.html">Searching for Public TCR/BCR Clusters article on package website</a></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Brian Neal (<a href="mailto:Brian.Neal@ucsf.edu">Brian.Neal@ucsf.edu</a>)</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="findPublicClusters.html">findPublicClusters()</a></code>
<code><a href="buildPublicClusterNetwork.html">buildPublicClusterNetwork()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Simulate 30 samples with a mix of public/private sequences ##</span></span></span>
<span class="r-in"><span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fl">30</span></span></span>
<span class="r-in"><span><span class="va">sample_size</span> <span class="op">&lt;-</span> <span class="fl">30</span> <span class="co"># (seqs per sample)</span></span></span>
<span class="r-in"><span><span class="va">base_seqs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">"CASSIEGQLSTDTQYF"</span>, <span class="st">"CASSEEGQLSTDTQYF"</span>, <span class="st">"CASSSVETQYF"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"CASSPEGQLSTDTQYF"</span>, <span class="st">"RASSLAGNTEAFF"</span>, <span class="st">"CASSHRGTDTQYF"</span>, <span class="st">"CASDAGVFQPQHF"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"CASSLTSGYNEQFF"</span>, <span class="st">"CASSETGYNEQFF"</span>, <span class="st">"CASSLTGGNEQFF"</span>, <span class="st">"CASSYLTGYNEQFF"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"CASSLTGNEQFF"</span>, <span class="st">"CASSLNGYNEQFF"</span>, <span class="st">"CASSFPWDGYGYTF"</span>, <span class="st">"CASTLARQGGELFF"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"CASTLSRQGGELFF"</span>, <span class="st">"CSVELLPTGPLETSYNEQFF"</span>, <span class="st">"CSVELLPTGPSETSYNEQFF"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"CVELLPTGPSETSYNEQFF"</span>, <span class="st">"CASLAGGRTQETQYF"</span>, <span class="st">"CASRLAGGRTQETQYF"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"CASSLAGGRTETQYF"</span>, <span class="st">"CASSLAGGRTQETQYF"</span>, <span class="st">"CASSRLAGGRTQETQYF"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"CASQYGGGNQPQHF"</span>, <span class="st">"CASSLGGGNQPQHF"</span>, <span class="st">"CASSNGGGNQPQHF"</span>, <span class="st">"CASSYGGGGNQPQHF"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"CASSYGGGQPQHF"</span>, <span class="st">"CASSYKGGNQPQHF"</span>, <span class="st">"CASSYTGGGNQPQHF"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"CAWSSQETQYF"</span>, <span class="st">"CASSSPETQYF"</span>, <span class="st">"CASSGAYEQYF"</span>, <span class="st">"CSVDLGKGNNEQFF"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Relative generation probabilities</span></span></span>
<span class="r-in"><span><span class="va">pgen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/toeplitz.html" class="external-link">toeplitz</a></span><span class="op">(</span><span class="fl">0.6</span><span class="op">^</span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="va">sample_size</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span>, nrow <span class="op">=</span> <span class="va">samples</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">base_seqs</span><span class="op">)</span> <span class="op">-</span> <span class="va">samples</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="simulateToyData.html">simulateToyData</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  samples <span class="op">=</span> <span class="va">samples</span>,</span></span>
<span class="r-in"><span>  sample_size <span class="op">=</span> <span class="va">sample_size</span>,</span></span>
<span class="r-in"><span>  prefix_length <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  prefix_chars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">""</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  prefix_probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">samples</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">samples</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  affixes <span class="op">=</span> <span class="va">base_seqs</span>,</span></span>
<span class="r-in"><span>  affix_probs <span class="op">=</span> <span class="va">pgen</span>,</span></span>
<span class="r-in"><span>  num_edits <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>  output_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  no_return <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## 1. Find Public Clusters in Each Sample</span></span></span>
<span class="r-in"><span><span class="va">sample_files</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Sample"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">samples</span>, <span class="st">".rds"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="findPublicClusters.html">findPublicClusters</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  file_list <span class="op">=</span> <span class="va">sample_files</span>,</span></span>
<span class="r-in"><span>  input_type <span class="op">=</span> <span class="st">"rds"</span>,</span></span>
<span class="r-in"><span>  seq_col <span class="op">=</span> <span class="st">"CloneSeq"</span>,</span></span>
<span class="r-in"><span>  count_col <span class="op">=</span> <span class="st">"CloneCount"</span>,</span></span>
<span class="r-in"><span>  min_seq_length <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>  drop_matches <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>  top_n_clusters <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>  min_node_count <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>  min_clone_count <span class="op">=</span> <span class="fl">15000</span>,</span></span>
<span class="r-in"><span>  output_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## 2. Build Public Cluster Network by Representative TCR/BCRs</span></span></span>
<span class="r-in"><span><span class="fu">buildPublicClusterNetworkByRepresentative</span><span class="op">(</span></span></span>
<span class="r-in"><span>  file_list <span class="op">=</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"cluster_meta_data"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      full.names <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>,</span></span>
<span class="r-in"><span>  size_nodes_by <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  print_plots <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="buildPublicClusterNetworkByRepresentative-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \dontshow{</span></span></span>
<span class="r-in"><span><span class="co"># Clean up temporary files</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.remove</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Sample"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">samples</span>, <span class="st">".rds"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"node_meta_data"</span>, <span class="st">"cluster_meta_data"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  recursive <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Brian Neal, Hai Yang, Phi Long Le, Li Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

