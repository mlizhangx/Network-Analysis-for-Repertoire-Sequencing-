<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Given the node-level metadata and adjacency matrix for an immune repertoire network, perform clustering and compute cluster-level network properties."><title>Compute Cluster-Level Network Statistics — getClusterStats • NAIR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute Cluster-Level Network Statistics — getClusterStats"><meta property="og:description" content="Given the node-level metadata and adjacency matrix for an immune repertoire network, perform clustering and compute cluster-level network properties."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">NAIR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.9043</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/NAIR.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/associated_clusters.html">Searching for Associated TCR/BCR Clusters</a>
    <a class="dropdown-item" href="../articles/buildRepSeqNetwork.html">buildRepSeqNetwork</a>
    <a class="dropdown-item" href="../articles/dual_chain.html">Dual-Chain Network Analysis</a>
    <a class="dropdown-item" href="../articles/network_visualization.html">Network Visualization</a>
    <a class="dropdown-item" href="../articles/public_clusters.html">Searching for Public TCR/BCR Clusters</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mlizhangx/Network-Analysis-for-Repertoire-Sequencing-/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Compute Cluster-Level Network Statistics</h1>
      
      <div class="d-none name"><code>getClusterStats.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Given the node-level metadata and adjacency matrix for an immune repertoire network, perform clustering and compute cluster-level network properties.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">getClusterStats</span><span class="op">(</span></span>
<span>    <span class="va">data</span>,</span>
<span>    <span class="va">adjacency_matrix</span>,</span>
<span>    seq_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    count_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    cluster_id_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    degree_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    cluster_fun <span class="op">=</span> <span class="va">cluster_fast_greedy</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>A data frame containing the node-level metadata for the network, with each row corresponding to a network node.</p></dd>

  <dt>adjacency_matrix</dt>
<dd><p>The adjacency matrix for the network.</p></dd>

  <dt>seq_col</dt>
<dd><p>Specifies the column of <code>data</code> containing the receptor sequences. Accepts either the column name or column index. If provided, then related cluster-level properties will be computed.</p></dd>

  <dt>count_col</dt>
<dd><p>Specifies the column of <code>data</code> containing a variable with counts (such as clone count or UMI count). Accepts either the column name or column index. If provided, then related cluster-level properties will be computed.</p></dd>

  <dt>cluster_id_col</dt>
<dd><p>If cluster analysis has been previously performed to partition the graph into clusters, this argument specifies the column of <code>data</code> containing the ID of the cluster to which each node belongs. Accepts either the column name or column index. If <code>NULL</code>, then <code><a href="addClusterMembership.html">addClusterMembership</a></code> will be used to partition the graph into clusters.</p></dd>

  <dt>degree_col</dt>
<dd><p>Specifies the column of <code>data</code> containing the network degree of each node. Accepts either the column name or column index. If <code>NULL</code>, the network degree of each node will be computed.</p></dd>

  <dt>cluster_fun</dt>
<dd><p>If <code>cluster_id_col = NULL</code>, this argument specifies the clustering algorithm used to partition the graph into clusters. Passed to <code><a href="addClusterMembership.html">addClusterMembership</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The cluster-level properties <code>diameter_length</code>, <code>assortativity</code>, <code>transitivity</code>, <code>edge_density</code>, <code>degree_centrality_index</code>, <code>closeness_centrality_index</code>, <code>eigen_centrality_index</code>, and <code>eigen_centrality_eigenvalue</code> are computed for each cluster using the corresponding submatrix of the network adjacency matrix.</p>


    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A data frame containing one row for each cluster and the following variables:</p>
<dl><dt>cluster_id</dt>
<dd><p>The cluster ID number.</p></dd>

  <dt>node_count</dt>
<dd><p>The number of nodes in the cluster.</p></dd>

  <dt>mean_seq_length</dt>
<dd><p>The mean sequence length in the cluster.</p></dd>

  <dt>mean_degree</dt>
<dd><p>The mean network degree in the cluster.</p></dd>

  <dt>max_degree</dt>
<dd><p>The maximum network degree in the cluster.</p></dd>

  <dt>seq_w_max_degree</dt>
<dd><p>The receptor sequence possessing the maximum degree within the cluster.</p></dd>

  <dt>agg_count</dt>
<dd><p>The aggregate count among all nodes in the cluster (based on the counts in <code>count_col</code>).</p></dd>

  <dt>max_count</dt>
<dd><p>The maximum count among all nodes in the cluster (based on the counts in <code>count_col</code>).</p></dd>

  <dt>seq_w_max_count</dt>
<dd><p>The receptor sequence possessing the maximum count within the cluster.</p></dd>

  <dt>diameter_length</dt>
<dd><p>The longest geodesic distance in the cluster, computed as the length of the vector returned by <code><a href="https://r.igraph.org/reference/diameter.html" class="external-link">get_diameter</a></code>.</p></dd>

  <dt>assortativity</dt>
<dd><p>The assortativity coefficient of the cluster's graph, based on the degree (minus one) of each node in the cluster (with the degree computed based only upon the nodes within the cluster). Computed using <code><a href="https://r.igraph.org/reference/assortativity.html" class="external-link">assortativity_degree</a></code>.</p></dd>

  <dt>global_transitivity</dt>
<dd><p>The transitivity (i.e., clustering coefficient) for the cluster's graph, which estimates the probability that adjacent vertices are connected. Computed using <code><a href="https://r.igraph.org/reference/transitivity.html" class="external-link">transitivity</a></code> with <code>type = "global"</code>.</p></dd>

  <dt>edge_density</dt>
<dd><p>The number of edges in the cluster as a fraction of the maximum possible number of edges. Computed using <code><a href="https://r.igraph.org/reference/edge_density.html" class="external-link">edge_density</a></code>.</p></dd>

  <dt>degree_centrality_index</dt>
<dd><p>The cluster-level centrality index based on degree within the cluster graph. Computed as the <code>centralization</code> element of the output from  <code><a href="https://r.igraph.org/reference/centr_degree.html" class="external-link">centr_degree</a></code>.</p></dd>

  <dt>closeness_centrality_index</dt>
<dd><p>The cluster-level centrality index based on closeness, i.e., distance to other nodes in the cluster. Computed using <code><a href="https://r.igraph.org/reference/centralize.html" class="external-link">centralization</a></code>.</p></dd>

  <dt>eigen_centrality_index</dt>
<dd><p>The cluster-level centrality index based on the eigenvector centrality scores, i.e., values of the first eigenvector of the adjacency matrix for the cluster. Computed as the <code>centralization</code> element of the output from  <code><a href="https://r.igraph.org/reference/centr_eigen.html" class="external-link">centr_eigen</a></code>.</p></dd>

  <dt>eigen_centrality_eigenvalue</dt>
<dd><p>The eigenvalue corresponding to the first eigenvector of the adjacency matrix for the cluster. Computed as the <code>value</code> element of the output from  <code><a href="https://r.igraph.org/reference/eigen_centrality.html" class="external-link">eigen_centrality</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Hai Yang, Jason Cham, Brian Neal, Zenghua Fan, Tao He and Li Zhang. (2023). NAIR: Network Analysis of Immune Repertoire. <em>Frontiers in Immunology</em>, vol. 14. <a href="https://doi.org/10.3389/fimmu.2023.1181825" class="external-link">https://doi.org/10.3389/fimmu.2023.1181825</a></p>
<p><a href="https://mlizhangx.github.io/Network-Analysis-for-Repertoire-Sequencing-/index.html">Webpage for the NAIR package</a></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Brian Neal (<a href="mailto:Brian.Neal@ucsf.edu">Brian.Neal@ucsf.edu</a>)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># Simulate some toy data for demonstration</span></span></span>
<span class="r-in"><span><span class="va">toy_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="simulateToyData.html">simulateToyData</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate network for data</span></span></span>
<span class="r-in"><span><span class="va">net</span> <span class="op">&lt;-</span> <span class="fu"><a href="generateNetworkObjects.html">generateNetworkObjects</a></span><span class="op">(</span><span class="va">toy_data</span>, <span class="st">"CloneSeq"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get cluster stats</span></span></span>
<span class="r-in"><span><span class="va">cluster_info</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">getClusterStats</span><span class="op">(</span><span class="va">net</span><span class="op">$</span><span class="va">node_data</span>, <span class="va">net</span><span class="op">$</span><span class="va">adjacency_matrix</span>,</span></span>
<span class="r-in"><span>                  seq_col <span class="op">=</span> <span class="st">"CloneSeq"</span>, count_col <span class="op">=</span> <span class="st">"CloneCount"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Brian Neal, Hai Yang, Phi Long Le, Li Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

