<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Given a list of network objects returned by
    buildRepSeqNetwork() or
    generateNetworkObjects(),
    computes cluster-level network properties,
    performing clustering first if needed.
    The list of network objects is returned
    with the cluster properties added as a data frame."><title>Compute Cluster-Level Network Properties — addClusterStats • NAIR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute Cluster-Level Network Properties — addClusterStats"><meta property="og:description" content="Given a list of network objects returned by
    buildRepSeqNetwork() or
    generateNetworkObjects(),
    computes cluster-level network properties,
    performing clustering first if needed.
    The list of network objects is returned
    with the cluster properties added as a data frame."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">NAIR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.3.9002</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/NAIR.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/buildRepSeqNetwork.html">buildRepSeqNetwork()/buildNet()</a>
    <a class="dropdown-item" href="../articles/node_properties.html">Node-Level Network Properties</a>
    <a class="dropdown-item" href="../articles/cluster_analysis.html">Cluster Analysis</a>
    <a class="dropdown-item" href="../articles/network_visualization.html">Network Visualization</a>
    <a class="dropdown-item" href="../articles/supplementary.html">Supplementary Functions</a>
    <a class="dropdown-item" href="../articles/dual_chain.html">Dual-Chain Network Analysis</a>
    <a class="dropdown-item" href="../articles/associated_clusters.html">Searching for Associated TCR/BCR Clusters</a>
    <a class="dropdown-item" href="../articles/public_clusters.html">Searching for Public TCR/BCR Clusters</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mlizhangx/Network-Analysis-for-Repertoire-Sequencing-/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Compute Cluster-Level Network Properties</h1>
      
      <div class="d-none name"><code>addClusterStats.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Given a list of network objects returned by
    <code><a href="buildRepSeqNetwork.html">buildRepSeqNetwork()</a></code> or
    <code><a href="generateNetworkObjects.html">generateNetworkObjects()</a></code>,
    computes cluster-level network properties,
    performing clustering first if needed.
    The list of network objects is returned
    with the cluster properties added as a data frame.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">addClusterStats</span><span class="op">(</span></span>
<span>  <span class="va">net</span>,</span>
<span>  cluster_id_name <span class="op">=</span> <span class="st">"cluster_id"</span>,</span>
<span>  seq_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  count_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  degree_col <span class="op">=</span> <span class="st">"degree"</span>,</span>
<span>  cluster_fun <span class="op">=</span> <span class="st">"fast_greedy"</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>net</dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></code> of network objects conforming to the output of
      <code><a href="buildRepSeqNetwork.html">buildRepSeqNetwork()</a></code> or
      <code><a href="generateNetworkObjects.html">generateNetworkObjects()</a></code>.
      See details.</p></dd>

  <dt>cluster_id_name</dt>
<dd><p>A character string specifying the name of the cluster membership variable
      in <code>net$node_data</code> that identifies the cluster to which each node belongs.
      If the variable does not exist, it will be added by calling
      <code><a href="addClusterMembership.html">addClusterMembership()</a></code>.
      If the variable does exist, its values will be used
      unless <code>overwrite = TRUE</code>,
      in which case its values will be overwritten and the new values used.</p></dd>

  <dt>seq_col</dt>
<dd><p>Specifies the column(s) of <code>net$node_data</code> containing
      the receptor sequences upon whose similarity the network is based.
      Accepts a character or numeric vector of length 1 or 2,
      containing either column names or column indices.
      If provided, related cluster-level properties will be computed.
      The default <code>NULL</code> will use the value contained in
      <code>net$details$seq_col</code> if it exists and is valid.</p></dd>

  <dt>count_col</dt>
<dd><p>Specifies the column of <code>net$node_data</code> containing
      a measure of abundance (such as clone count or UMI count).
      Accepts a character string containing the column name
      or a numeric scalar containing the column index.
      If provided,  related cluster-level properties will be computed.</p></dd>

  <dt>degree_col</dt>
<dd><p>Specifies the column of <code>net$node_data</code> containing
      the network degree of each node.
      Accepts a character string containing the column name.
      If the column does not exist, it will be added.</p></dd>

  <dt>cluster_fun</dt>
<dd><p>A character string specifying the clustering algorithm to use when
      adding or overwriting the cluster membership variable in
      <code>net$node_data</code> specified by <code>cluster_id_name</code>.
      Passed to <code><a href="addClusterMembership.html">addClusterMembership()</a></code>.</p></dd>

  <dt>overwrite</dt>
<dd><p>Logical. If <code>TRUE</code> and <code>net</code> already contains an element named
      <code>cluster_data</code>, it will be overwritten. Similarly, if
      <code>overwrite = TRUE</code> and <code>net$node_data</code> contains a variable whose
      name matches the value of <code>cluster_id_name</code>, then its values will be
      overwritten with new cluster membership values (obtained using
      <code><a href="addClusterMembership.html">addClusterMembership()</a></code>
      with the specified value of <code>cluster_fun</code>),
      and cluster properties will be computed based on the new values.</p></dd>

  <dt>verbose</dt>
<dd><p>Logical. If <code>TRUE</code>, generates messages about the tasks
      performed and their progress, as well as relevant properties of intermediate
      outputs. Messages are sent to <code><a href="https://rdrr.io/r/base/showConnections.html" class="external-link">stderr()</a></code>.</p></dd>

  <dt>...</dt>
<dd><p>Named optional arguments to the function specified by <code>cluster_fun</code>.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The list <code>net</code> must contain the named elements
    <code>igraph</code> (of class <code><a href="https://r.igraph.org/reference/aaa-igraph-package.html" class="external-link">igraph</a></code>),
    <code>adjacency_matrix</code> (a <code><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></code> or
    <code><a href="https://rdrr.io/pkg/Matrix/man/dgCMatrix-class.html" class="external-link">dgCMatrix</a></code> encoding edge connections),
    and <code>node_data</code> (a <code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></code> containing node metadata),
    all corresponding to the same network. The lists returned by
    <code><a href="buildRepSeqNetwork.html">buildRepSeqNetwork()</a></code> and
    <code><a href="generateNetworkObjects.html">generateNetworkObjects()</a></code>
    are examples of valid inputs for the <code>net</code> argument.</p>
<p>If the network graph has previously been partitioned into clusters using
    <code><a href="addClusterMembership.html">addClusterMembership()</a></code> and the user
    wishes to compute network properties for these clusters, the name of the
    cluster membership variable in <code>net$node_data</code> should be provided to
    the <code>cluster_id_name</code> argument.</p>
<p>If the value of <code>cluster_id_name</code> is not the name of a variable
    in <code>net$node_data</code>, then clustering is performed using
    <code><a href="addClusterMembership.html">addClusterMembership()</a></code>
    with the specified value of <code>cluster_fun</code>,
    and the cluster membership values are written to <code>net$node_data</code> using
    the value of <code>cluster_id_name</code> as the variable name.
    If <code>overwrite = TRUE</code>, this is done even if this variable already exists.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A modified copy of <code>net</code>, with cluster properties contained in the element</p>
<p></p>
<p><code>cluster_data</code>. This is a <code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></code> containing
  one row for each cluster in the network and the following variables:</p>
<dl><dt>cluster_id</dt>
<dd><p>The cluster ID number.</p></dd>

  <dt>node_count</dt>
<dd><p>The number of nodes in the cluster.</p></dd>

  <dt>mean_seq_length</dt>
<dd><p>The mean sequence length in the cluster.
  Only present when <code>length(seq_col) == 1</code>.</p></dd>

  <dt>A_mean_seq_length</dt>
<dd><p>The mean first sequence length in the cluster.
  Only present when <code>length(seq_col) == 2</code>.</p></dd>

  <dt>B_mean_seq_length</dt>
<dd><p>The mean second sequence length in the cluster.
  Only present when <code>length(seq_col) == 2</code>.</p></dd>

  <dt>mean_degree</dt>
<dd><p>The mean network degree in the cluster.</p></dd>

  <dt>max_degree</dt>
<dd><p>The maximum network degree in the cluster.</p></dd>

  <dt>seq_w_max_degree</dt>
<dd><p>The receptor sequence possessing the maximum degree within the cluster.
  Only present when <code>length(seq_col) == 1</code>.</p></dd>

  <dt>A_seq_w_max_degree</dt>
<dd><p>The first sequence of the node possessing the maximum degree within the cluster.
  Only present when <code>length(seq_col) == 2</code>.</p></dd>

  <dt>B_seq_w_max_degree</dt>
<dd><p>The second sequence of the node possessing the maximum degree within the cluster.
  Only present when <code>length(seq_col) == 2</code>.</p></dd>

  <dt>agg_count</dt>
<dd><p>The aggregate count among all nodes in the cluster (based on the counts in
  <code>count_col</code>).</p></dd>

  <dt>max_count</dt>
<dd><p>The maximum count among all nodes in the cluster (based on the counts in
  <code>count_col</code>).</p></dd>

  <dt>seq_w_max_count</dt>
<dd><p>The receptor sequence possessing the maximum count within the cluster.
  Only present when <code>length(seq_col) == 1</code>.</p></dd>

  <dt>A_seq_w_max_count</dt>
<dd><p>The first sequence of the node possessing the maximum count within the cluster.
  Only present when <code>length(seq_col) == 2</code>.</p></dd>

  <dt>B_seq_w_max_count</dt>
<dd><p>The second sequence of the node possessing the maximum count within the cluster.
  Only present when <code>length(seq_col) == 2</code>.</p></dd>

  <dt>diameter_length</dt>
<dd><p>The longest geodesic distance in the cluster, computed as the length of the
  vector returned by <code><a href="https://r.igraph.org/reference/diameter.html" class="external-link">get_diameter()</a></code>.</p></dd>

  <dt>assortativity</dt>
<dd><p>The assortativity coefficient of the cluster's graph, based on the degree
  (minus one) of each node in the cluster (with the degree computed based only
  upon the nodes within the cluster). Computed using
  <code><a href="https://r.igraph.org/reference/assortativity.html" class="external-link">assortativity_degree()</a></code>.</p></dd>

  <dt>global_transitivity</dt>
<dd><p>The transitivity (i.e., clustering coefficient) for the cluster's graph, which
  estimates the probability that adjacent vertices are connected. Computed using
  <code><a href="https://r.igraph.org/reference/transitivity.html" class="external-link">transitivity()</a></code> with <code>type = "global"</code>.</p></dd>

  <dt>edge_density</dt>
<dd><p>The number of edges in the cluster as a fraction of the maximum possible number
  of edges. Computed using <code><a href="https://r.igraph.org/reference/edge_density.html" class="external-link">edge_density()</a></code>.</p></dd>

  <dt>degree_centrality_index</dt>
<dd><p>The centrality index of the cluster's graph based on within-cluster network degree.
  Computed as the <code>centralization</code> element of the output from
  <code><a href="https://r.igraph.org/reference/centr_degree.html" class="external-link">centr_degree()</a></code>.</p></dd>

  <dt>closeness_centrality_index</dt>
<dd><p>The centrality index of the cluster's graph based on closeness,
  i.e., distance to other nodes in the cluster.
  Computed using <code><a href="https://r.igraph.org/reference/centralize.html" class="external-link">centralization()</a></code>.</p></dd>

  <dt>eigen_centrality_index</dt>
<dd><p>The centrality index of the cluster's graph based on the eigenvector centrality scores,
  i.e., values of the first eigenvector of the adjacency matrix for the cluster.
  Computed as the <code>centralization</code> element of the output from
  <code><a href="https://r.igraph.org/reference/centr_eigen.html" class="external-link">centr_eigen()</a></code>.</p></dd>

  <dt>eigen_centrality_eigenvalue</dt>
<dd><p>The eigenvalue corresponding to the first eigenvector of the adjacency matrix
  for the cluster. Computed as the <code>value</code> element of the output from
  <code><a href="https://r.igraph.org/reference/eigen_centrality.html" class="external-link">eigen_centrality()</a></code>.</p></dd>


</dl><p>If <code>net$node_data</code> did not previously contain a variable whose name matches
  the value of <code>cluster_id_name</code>, then this variable will be present
  and will contain values for cluster membership, obtained through a call to</p>
<p></p>
<p><code><a href="addClusterMembership.html">addClusterMembership()</a></code></p>


<p>using the clustering algorithm specified by <code>cluster_fun</code>.</p>


<p>If <code>net$node_data</code> did previously contain a variable whose name matches
  the value of <code>cluster_id_name</code> and <code>overwrite = TRUE</code>, then the
  values of this variable will be overwritten with new values for cluster membership,
  obtained as above based on <code>cluster_fun</code>.</p>


<p>If <code>net$node_data</code> did not previously contain a variable whose name matches
  the value of <code>degree_col</code>, then this variable will be present
  and will contain values for network degree.</p>


<p>Additionally, if <code>net</code> contains a list named <code>details</code>, then the
  following elements will be added to <code>net$details</code>, or overwritten if they
  already exist:</p>
<dl><dt><code>cluster_data_goes_with</code></dt>
<dd><p>A character string containing the value of <code>cluster_id_name</code>.
      When <code>net$node_data</code> contains multiple cluster membership variables
      (e.g., from applying different clustering methods),
      <code>cluster_data_goes_with</code> allows the user
      to distinguish which of these variables corresponds to
      <code>net$cluster_data</code>.</p></dd>

  <dt><code>count_col_for_cluster_data</code></dt>
<dd><p>A character string containing the value of <code>count_col</code>.
      If <code>net$node_data</code> contains multiple count variables, this allows
      the user to distinguish which of these variables corresponds to the
      count-related properties in <code>net$cluster_data</code>, such as
      <code>max_count</code>.
      If <code>count_col = NULL</code>, then the value will be <code>NA</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Hai Yang, Jason Cham, Brian Neal, Zenghua Fan, Tao He and Li Zhang. (2023).
NAIR: Network Analysis of Immune Repertoire. <em>Frontiers in Immunology</em>, vol. 14.
<a href="https://www.frontiersin.org/articles/10.3389/fimmu.2023.1181825/full" class="external-link">doi: 10.3389/fimmu.2023.1181825</a></p>
<p><a href="https://mlizhangx.github.io/Network-Analysis-for-Repertoire-Sequencing-/index.html">Webpage for the NAIR package</a></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Brian Neal (<a href="mailto:Brian.Neal@ucsf.edu">Brian.Neal@ucsf.edu</a>)</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="addClusterMembership.html">addClusterMembership()</a></code>
<code><a href="getClusterStats.html">getClusterStats()</a></code>
<code><a href="addClusterLabels.html">labelClusters()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">toy_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="simulateToyData.html">simulateToyData</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">net</span> <span class="op">&lt;-</span> <span class="fu"><a href="generateNetworkObjects.html">generateNetworkObjects</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">toy_data</span>, <span class="st">"CloneSeq"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">net</span> <span class="op">&lt;-</span> <span class="fu">addClusterStats</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">net</span>,</span></span>
<span class="r-in"><span>  count_col <span class="op">=</span> <span class="st">"CloneCount"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">net</span><span class="op">$</span><span class="va">cluster_data</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   cluster_id node_count mean_seq_length mean_degree max_degree seq_w_max_degree</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          1         14           13.00        3.36          9    AAAAAAAAATTGC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          2         28           12.96        8.43         18    GGGGGGGAATTGG</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3          3          9           12.67        2.22          4     AGAAGAAAATTC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4          4          6           13.00        3.33          9    GGGGGGAAATTGG</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5          5          6           12.00        2.17          3     AGGGAGGAATTC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6          6         25           12.00        4.60         10     AAAAAAAAATTG</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   agg_count max_count seq_w_max_count diameter_length global_transitivity</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     52760      4618   AGAAGAAAATTGC               5           0.5454545</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    115851      6526   GGGGGGGAATTGG               6           0.6084437</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     28477      4422   GAAATAGAATTCG               7           0.2727273</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     23120      5873   AGGGGGAAATTGG               4           0.3750000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     24291      5728    AGGGGGGAATTC               5           0.4285714</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     89616      5393    GAAAAAAAATTC               6           0.3435115</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   assortativity edge_density degree_centrality_index closeness_centrality_index</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   -0.13886606    0.2307692               0.3076923                  0.5584465</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   -0.05857037    0.2962963               0.3333333                  0.4703335</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   -0.68750000    0.2500000               0.1250000                  0.2311674</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   -0.50000000    0.4000000               0.2000000                  0.4266234</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   -0.09090909    0.4000000               0.2000000                  0.3301948</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   -0.14219251    0.1766667               0.1983333                  0.4012791</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   eigen_centrality_index eigen_centrality_eigenvalue</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1              0.6572455                    3.627940</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2              0.5524239                   11.831606</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3              0.6748055                    2.238772</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4              0.5237142                    2.278414</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5              0.5707806                    2.228328</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6              0.6291788                    5.885769</span>
<span class="r-in"><span><span class="va">net</span><span class="op">$</span><span class="va">details</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $seq_col</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "CloneSeq"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dist_type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "hamming"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dist_cutoff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $drop_isolated_nodes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $nodes_in_network</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $clusters_in_network</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fast_greedy </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          20 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cluster_id_variable</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  fast_greedy </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "cluster_id" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cluster_data_goes_with</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "cluster_id"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $count_col_for_cluster_data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "CloneCount"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># won't change net since net$cluster_data exists</span></span></span>
<span class="r-in"><span><span class="va">net</span> <span class="op">&lt;-</span> <span class="fu">addClusterStats</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">net</span>,</span></span>
<span class="r-in"><span>  count_col <span class="op">=</span> <span class="st">"CloneCount"</span>,</span></span>
<span class="r-in"><span>  cluster_fun <span class="op">=</span> <span class="st">"leiden"</span>,</span></span>
<span class="r-in"><span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Obtaining cluster properties...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ‘net$cluster_data’ already exists.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> To overwrite, call ‘addClusterStats()’ with ‘overwrite = TRUE’</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># overwrites values in net$cluster_data</span></span></span>
<span class="r-in"><span><span class="co"># and cluster membership values in net$node_data$cluster_id</span></span></span>
<span class="r-in"><span><span class="co"># with values obtained using "cluster_leiden" algorithm</span></span></span>
<span class="r-in"><span><span class="va">net</span> <span class="op">&lt;-</span> <span class="fu">addClusterStats</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">net</span>,</span></span>
<span class="r-in"><span>  count_col <span class="op">=</span> <span class="st">"CloneCount"</span>,</span></span>
<span class="r-in"><span>  cluster_fun <span class="op">=</span> <span class="st">"leiden"</span>,</span></span>
<span class="r-in"><span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">net</span><span class="op">$</span><span class="va">details</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $seq_col</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "CloneSeq"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dist_type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "hamming"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dist_cutoff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $drop_isolated_nodes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $nodes_in_network</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $clusters_in_network</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> leiden </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     57 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cluster_id_variable</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       leiden </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "cluster_id" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cluster_data_goes_with</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "cluster_id"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $count_col_for_cluster_data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "CloneCount"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># overwrites existing values in net$cluster_data</span></span></span>
<span class="r-in"><span><span class="co"># with values obtained using "cluster_louvain" algorithm</span></span></span>
<span class="r-in"><span><span class="co"># saves cluster membership values to net$node_data$cluster_id_louvain</span></span></span>
<span class="r-in"><span><span class="co"># (net$node_data$cluster_id retains membership values from "cluster_leiden")</span></span></span>
<span class="r-in"><span><span class="va">net</span> <span class="op">&lt;-</span> <span class="fu">addClusterStats</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">net</span>,</span></span>
<span class="r-in"><span>  count_col <span class="op">=</span> <span class="st">"CloneCount"</span>,</span></span>
<span class="r-in"><span>  cluster_fun <span class="op">=</span> <span class="st">"louvain"</span>,</span></span>
<span class="r-in"><span>  cluster_id_name <span class="op">=</span> <span class="st">"cluster_id_louvain"</span>,</span></span>
<span class="r-in"><span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">net</span><span class="op">$</span><span class="va">details</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $seq_col</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "CloneSeq"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dist_type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "hamming"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dist_cutoff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $drop_isolated_nodes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $nodes_in_network</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $clusters_in_network</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  leiden louvain </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      57      19 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cluster_id_variable</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               leiden              louvain </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         "cluster_id" "cluster_id_louvain" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cluster_data_goes_with</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "cluster_id_louvain"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $count_col_for_cluster_data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "CloneCount"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># perform clustering using "cluster_fast_greedy" algorithm,</span></span></span>
<span class="r-in"><span><span class="co"># save cluster membership values to net$node_data$cluster_id_greedy</span></span></span>
<span class="r-in"><span><span class="va">net</span> <span class="op">&lt;-</span> <span class="fu"><a href="addClusterMembership.html">addClusterMembership</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">net</span>,</span></span>
<span class="r-in"><span>  cluster_fun <span class="op">=</span> <span class="st">"fast_greedy"</span>,</span></span>
<span class="r-in"><span>  cluster_id_name <span class="op">=</span> <span class="st">"cluster_id_greedy"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compute cluster properties for the clusters from previous step</span></span></span>
<span class="r-in"><span><span class="co"># overwrites values in net$cluster_data</span></span></span>
<span class="r-in"><span><span class="va">net</span> <span class="op">&lt;-</span> <span class="fu">addClusterStats</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">net</span>,</span></span>
<span class="r-in"><span>  cluster_id_name <span class="op">=</span> <span class="st">"cluster_id_greedy"</span>,</span></span>
<span class="r-in"><span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">net</span><span class="op">$</span><span class="va">details</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $seq_col</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "CloneSeq"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dist_type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "hamming"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dist_cutoff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $drop_isolated_nodes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $nodes_in_network</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $clusters_in_network</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      leiden     louvain fast_greedy </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          57          19          20 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cluster_id_variable</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               leiden              louvain          fast_greedy </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         "cluster_id" "cluster_id_louvain"  "cluster_id_greedy" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cluster_data_goes_with</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "cluster_id_greedy"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $count_col_for_cluster_data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Brian Neal, Hai Yang, Daniil Matveev, Phi Long Le, Li Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

