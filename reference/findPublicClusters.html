<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="
    Given multiple samples of RepSeq data, perform network analysis on each
    sample individually and filter clusters by node count and clone count."><title>
    Find Public Clusters Among RepSeq Samples — findPublicClusters • NAIR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="
    Find Public Clusters Among RepSeq Samples — findPublicClusters"><meta property="og:description" content="
    Given multiple samples of RepSeq data, perform network analysis on each
    sample individually and filter clusters by node count and clone count."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">NAIR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.9040</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/NAIR.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/associated_clusters.html">Searching for Associated TCR/BCR Clusters</a>
    <a class="dropdown-item" href="../articles/buildRepSeqNetwork.html">buildRepSeqNetwork</a>
    <a class="dropdown-item" href="../articles/dual_chain.html">Dual-Chain Network Analysis</a>
    <a class="dropdown-item" href="../articles/network_visualization.html">Network Visualization</a>
    <a class="dropdown-item" href="../articles/public_clusters.html">Searching for Public TCR/BCR Clusters</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1><!-- %%  ~~function to do ... ~~ -->
    Find Public Clusters Among RepSeq Samples</h1>
      
      <div class="d-none name"><code>findPublicClusters.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><!-- %%  ~~ A concise (1-5 lines) description of what the function does. ~~ -->
    Given multiple samples of RepSeq data, perform network analysis on each
    sample individually and filter clusters by node count and clone count.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">findPublicClusters</span><span class="op">(</span></span>
<span></span>
<span>  <span class="co">## Input ##</span></span>
<span>  <span class="va">file_list</span>, <span class="va">input_type</span>,</span>
<span>  data_symbols <span class="op">=</span> <span class="cn">NULL</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, sep <span class="op">=</span> <span class="st">""</span>,</span>
<span>  sample_ids <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">file_list</span><span class="op">)</span>,</span>
<span>  <span class="va">seq_col</span>, count_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  min_seq_length <span class="op">=</span> <span class="fl">3</span>, drop_matches <span class="op">=</span> <span class="st">"[*|_]"</span>,</span>
<span></span>
<span>  <span class="co">## Network ##</span></span>
<span>  top_n_clusters <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  min_node_count <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  min_clone_count <span class="op">=</span> <span class="fl">100</span>,</span>
<span></span>
<span>  <span class="co">## Visualization ##</span></span>
<span>  plots <span class="op">=</span> <span class="cn">FALSE</span>, print_plots <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  plot_title <span class="op">=</span> <span class="st">"auto"</span>, color_nodes_by <span class="op">=</span> <span class="st">"cluster_id"</span>,</span>
<span></span>
<span>  <span class="co">## Output ##</span></span>
<span>  output_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"public_clusters"</span><span class="op">)</span>,</span>
<span>  output_type <span class="op">=</span> <span class="st">"rds"</span>,</span>
<span>  output_dir_unfiltered <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  output_type_unfiltered <span class="op">=</span> <span class="st">"rds"</span>,</span>
<span>  <span class="va">...</span></span>
<span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>file_list</dt>
<dd><p><!-- %%     ~~Describe \code{file_list} here~~ -->
  Passed to <code>loadDataFromFileList</code>(one data frame per sample).</p></dd>

  <dt>input_type</dt>
<dd><p><!-- %%     ~~Describe \code{input_type} here~~ -->
  Passed to <code><a href="combineSamples.html">loadDataFromFileList</a></code>.</p></dd>

  <dt>data_symbols</dt>
<dd><p><!-- %%     ~~Describe \code{data_symbols} here~~ -->
  Passed to <code><a href="combineSamples.html">loadDataFromFileList</a></code>.</p></dd>

  <dt>header</dt>
<dd><p><!-- %%     ~~Describe \code{header} here~~ -->
  Passed to <code><a href="combineSamples.html">loadDataFromFileList</a></code>.</p></dd>

  <dt>sep</dt>
<dd><p><!-- %%     ~~Describe \code{sep} here~~ -->
  Passed to <code><a href="combineSamples.html">loadDataFromFileList</a></code>.</p></dd>

  <dt>sample_ids</dt>
<dd><p><!-- %%     ~~Describe \code{sample_ids} here~~ -->
  A character or numeric vector of sample IDs, whose length matches that of <code>file_list</code>. The values
  should be valid for use in filenames.</p></dd>

  <dt>seq_col</dt>
<dd><p><!-- %%     ~~Describe \code{seq_col} here~~ -->
    The column name or number of each sample's data frame that contains the receptor sequences to be used as the basis of similarity between rows during network analysis. This column must have the same name in each sample.</p></dd>

  <dt>count_col</dt>
<dd><p><!-- %%     ~~Describe \code{count_col} here~~ -->
    The column name or number of each sample's data frame that contains the measure of clonal abundance to be used when filtering the clusters. This column must have the same name in each sample.</p></dd>

  <dt>min_seq_length</dt>
<dd><p><!-- %%     ~~Describe \code{drop_matches} here~~ -->
    Passed to <code><a href="buildRepSeqNetwork.html">buildRepSeqNetwork</a></code> when performing
    network analysis on each sample (prior to filtering the clusters).</p></dd>

  <dt>drop_matches</dt>
<dd><p><!-- %%     ~~Describe \code{drop_matches} here~~ -->
    Passed to <code><a href="buildRepSeqNetwork.html">buildRepSeqNetwork</a></code>.</p></dd>

  <dt>top_n_clusters</dt>
<dd><p><!-- %%     ~~Describe \code{top_n_clusters} here~~ -->
    The <code>top_n_clusters</code> clusters with the highest node count will
    automatically be included among the public clusters.</p></dd>

  <dt>min_node_count</dt>
<dd><p><!-- %%     ~~Describe \code{min_node_count} here~~ -->
    Clusters with node count of at least this value will be included
    among the public clusters.</p></dd>

  <dt>min_clone_count</dt>
<dd><p><!-- %%     ~~Describe \code{min_clone_count} here~~ -->
    Clusters with aggregate clone count of at least this value will be included
    among the public clusters.</p></dd>

  <dt>plots</dt>
<dd><p><!-- %%     ~~Describe \code{plots} here~~ -->
    Passed to <code><a href="buildRepSeqNetwork.html">buildRepSeqNetwork</a></code> when performing
    network analysis on each sample (prior to filtering the clusters).</p></dd>

  <dt>print_plots</dt>
<dd><p><!-- %%     ~~Describe \code{print_plots} here~~ -->
    Passed to <code><a href="buildRepSeqNetwork.html">buildRepSeqNetwork</a></code>.</p></dd>

  <dt>plot_title</dt>
<dd><p><!-- %%     ~~Describe \code{plot_title} here~~ -->
    Passed to <code><a href="buildRepSeqNetwork.html">buildRepSeqNetwork</a></code>.</p></dd>

  <dt>color_nodes_by</dt>
<dd><p><!-- %%     ~~Describe \code{color_nodes_by} here~~ -->
    Passed to <code><a href="buildRepSeqNetwork.html">buildRepSeqNetwork</a></code>.</p></dd>

  <dt>output_dir</dt>
<dd><p><!-- %%     ~~Describe \code{output_dir} here~~ -->
    The outpout directory to save the filtered network results for each sample.</p></dd>

  <dt>output_type</dt>
<dd><p><!-- %%     ~~Describe \code{output_type} here~~ -->
    A character string specifying the file format used to save the filtered
    results. Options include <code>"rds"</code>, <code>"csv"</code> and <code>"rda"</code>.</p></dd>

  <dt>output_dir_unfiltered</dt>
<dd><p><!-- %%     ~~Describe \code{output_dir_unfiltered} here~~ -->
    The output directory to save the unfiltered network results for each sample,
    if desired. If <code>NULL</code> (the default), only the filtered results are
    saved.</p></dd>

  <dt>output_type_unfiltered</dt>
<dd><p><!-- %%     ~~Describe \code{output_type_unfiltered} here~~ -->
    A character string specifying the file format scheme used to save the
    unfiltered network results for each sample. Only applicable if <code>output_dir_unfiltered</code>
    is non-null. Passed to <code><a href="buildRepSeqNetwork.html">buildRepSeqNetwork</a></code>.</p></dd>

  <dt>...</dt>
<dd><p><!-- %%     ~~Describe \code{\dots} here~~ -->
    Other arguments to <code><a href="buildRepSeqNetwork.html">buildRepSeqNetwork()</a></code>, not including <code>node_stats</code>, <code>stats_to_include</code> or <code>cluster_stats</code> (see details).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><!-- %%  ~~ If necessary, more details than the description above ~~ --></p>
<p>All node-level and cluster-level network properties are automatically computed
    for each sample. The node-level properties
    are renamed to reflect their association to the sample-level network. Specifically,
    the properties are named
    <code>ClusterIDInSample</code>, <code>SampleLevelNetworkDegree</code>,
    <code>SampleLevelTransitivity</code>, <code>SampleLevelCloseness</code>,
    <code>SampleLevelCentralityByCloseness</code>, <code>SampleLevelCentralityByEigen</code>,
    <code>SampleLevelEigenCentrality</code>, <code>SampleLevelBetweenness</code>,
    <code>SampleLevelCentralityByBetweenness</code>, <code>SampleLevelAuthorityScore</code>,
    <code>SampleLevelCoreness</code>, <code>SampleLevelPageRank</code>.
    A variable <code>SampleID</code> is
    added to both the node-level and cluster-level meta data for each sample.</p>
<p>After the clusters in each sample are filtered, the node-level and cluster-level
    meta data are saved in the subdirectories <code>node_meta_data</code> and
    <code>cluster_meta_data</code>, respectively, of <code>output_dir</code>; each is saved
    using the sample ID (the corresponding element of <code>sample_id_list</code>)
    as a filename prefix, followed by the appropriate file extension according
    to <code>output_type</code>.</p>
<p>The files containing the node-level meta data for the filtered clusters can
    be supplied to <code><a href="buildPublicClusterNetwork.html">buildPublicClusterNetwork</a></code> in order to combine the
    public clusters across samples and perform network analysis. The files
    containing the cluster-level meta data for the filtered clusters can be
    supplied to <code><a href="buildPublicClusterNetworkByRepresentative.html">buildPublicClusterNetworkByRepresentative</a></code> to build a
    network using only a single representative sequence from each cluster.</p>
<p>The unfiltered network results for each sample can also be saved by supplying
    a directory to <code>output_dir_unfiltered</code>, if these results are desired for
    downstream analysis.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Hai Yang, Jason Cham, Brian Neal, Zenghua Fan, Tao He and Li Zhang. (2023). NAIR: Network Analysis of Immune Repertoire. <em>Frontiers in Immunology</em>, vol. 14. https://doi.org/10.3389/fimmu.2023.1181825</p>
<p><a href="https://www.frontiersin.org/articles/10.3389/fimmu.2023.1181825" class="external-link">https://www.frontiersin.org/articles/10.3389/fimmu.2023.1181825</a></p>
<p><a href="https://github.com/mlizhangx/Network-Analysis-for-Repertoire-Sequencing-" class="external-link">https://github.com/mlizhangx/Network-Analysis-for-Repertoire-Sequencing-</a></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p><!-- %%  ~~who you are~~ -->
    Brian Neal (<a href="mailto:Brian.Neal@ucsf.edu">Brian.Neal@ucsf.edu</a>)

<!-- %% ~~objects to See Also as \code{\link{help}}, ~~~ -->
<code><a href="buildPublicClusterNetwork.html">buildPublicClusterNetwork</a></code><code><a href="buildPublicClusterNetworkByRepresentative.html">buildPublicClusterNetworkByRepresentative</a></code><a href="../doc/public_clusters.html">Public Clusters Vignette</a>


<!-- % Add one or more standard keywords, see file 'KEYWORDS' in the -->
<!-- % R documentation directory (show via RShowDoc("KEYWORDS")): -->
<!-- % \keyword{ ~kwd1 } -->
<!-- % \keyword{ ~kwd2 } -->
<!-- % Use only one keyword per line. -->
<!-- % For non-standard keywords, use \concept instead of \keyword: -->
<!-- % \concept{ ~cpt1 } -->
<!-- % \concept{ ~cpt2 } -->
<!-- % Use only one concept per line. --></p>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Brian Neal, Hai Yang, Le Phi Long, Li Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

