<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Aggregate Counts/Frequencies for Clones With Identical Receptor Sequences — aggregateIdenticalClones • NAIR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Aggregate Counts/Frequencies for Clones With Identical Receptor Sequences — aggregateIdenticalClones"><meta name="description" content="Given bulk Adaptive Immune Receptor Repertoire Sequencing (AIRR-Seq) data
    with clones indexed by row, returns a data frame containing one row for each
    unique receptor sequence. Includes the number of clones sharing each sequence,
    as well as aggregate values for clone count and clone frequency across all
    clones sharing each sequence. Clones can be grouped according to metadata,
    in which case aggregation is performed within (but not across) groups."><meta property="og:description" content="Given bulk Adaptive Immune Receptor Repertoire Sequencing (AIRR-Seq) data
    with clones indexed by row, returns a data frame containing one row for each
    unique receptor sequence. Includes the number of clones sharing each sequence,
    as well as aggregate values for clone count and clone frequency across all
    clones sharing each sequence. Clones can be grouped according to metadata,
    in which case aggregation is performed within (but not across) groups."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">NAIR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.4.9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/NAIR.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/buildRepSeqNetwork.html">buildRepSeqNetwork()/buildNet()</a></li>
    <li><a class="dropdown-item" href="../articles/node_properties.html">Node-Level Network Properties</a></li>
    <li><a class="dropdown-item" href="../articles/cluster_analysis.html">Cluster Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/network_visualization.html">Network Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/supplementary.html">Supplementary Functions</a></li>
    <li><a class="dropdown-item" href="../articles/dual_chain.html">Dual-Chain Network Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/associated_clusters.html">Searching for Associated TCR/BCR Clusters</a></li>
    <li><a class="dropdown-item" href="../articles/public_clusters.html">Searching for Public TCR/BCR Clusters</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mlizhangx/Network-Analysis-for-Repertoire-Sequencing-/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Aggregate Counts/Frequencies for Clones With Identical Receptor Sequences</h1>

      <div class="d-none name"><code>aggregateIdenticalClones.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Given bulk Adaptive Immune Receptor Repertoire Sequencing (AIRR-Seq) data
    with clones indexed by row, returns a data frame containing one row for each
    unique receptor sequence. Includes the number of clones sharing each sequence,
    as well as aggregate values for clone count and clone frequency across all
    clones sharing each sequence. Clones can be grouped according to metadata,
    in which case aggregation is performed within (but not across) groups.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">aggregateIdenticalClones</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">clone_col</span>,</span>
<span>  <span class="va">count_col</span>,</span>
<span>  <span class="va">freq_col</span>,</span>
<span>  grouping_cols <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame containing the bulk AIRR-Seq data, with clones indexed by row.</p></dd>

  <dt id="arg-clone-col">clone_col<a class="anchor" aria-label="anchor" href="#arg-clone-col"></a></dt>
<dd><p>Specifies the column of <code>data</code> containing
      the receptor sequences.
      Accepts a character string containing the column name
      or a numeric scalar containing the column index.</p></dd>

  <dt id="arg-count-col">count_col<a class="anchor" aria-label="anchor" href="#arg-count-col"></a></dt>
<dd><p>Specifies the column of <code>data</code> containing
      the clone counts.
      Accepts a character string containing the column name
      or a numeric scalar containing the column index.</p></dd>

  <dt id="arg-freq-col">freq_col<a class="anchor" aria-label="anchor" href="#arg-freq-col"></a></dt>
<dd><p>Specifies the column of <code>data</code> containing
      the clone frequencies.
      Accepts a character string containing the column name
      or a numeric scalar containing the column index.</p></dd>

  <dt id="arg-grouping-cols">grouping_cols<a class="anchor" aria-label="anchor" href="#arg-grouping-cols"></a></dt>
<dd><p>An optional character vector of column names
      or numeric vector of column indices, specifying
      one or more columns of <code>data</code> used to assign clones to groups.
      If provided, aggregation occurs within groups, but not across groups.
      See details.</p></dd>

  <dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, generates messages about the tasks
      performed and their progress, as well as relevant properties of intermediate
      outputs. Messages are sent to <code><a href="https://rdrr.io/r/base/showConnections.html" class="external-link">stderr()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If <code>grouping_cols</code> is left unspecified, the returned data frame will contain
  one row for each unique receptor sequence appearing in <code>data</code>.</p>
<p>If one or more columns of <code>data</code> are specified using the <code>grouping_cols</code>
  argument, then each clone (row) in <code>data</code> is assigned to a group based on its
  combination of values in these columns. If two clones share the same receptor sequence
  but belong to different groups, their receptor sequence will appear multiple times
  in the returned data frame, with one row for each group in which the sequence appears.
  In each such row, the aggregate clone count, aggregate clone frequency, and number of
  clones sharing the sequence are reported within the group for that row.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame whose first column contains the receptor sequences and has the
    same name as the column of <code>data</code> specified by <code>clone_col</code>. One
    additional column will be present for each column of <code>data</code> that is
    specified using the <code>grouping_cols</code> argument, with each having the same
    column name. The remaining columns are as follows:</p>
<p></p>
<dl><dt>AggregatedCloneCount</dt>
<dd><p>The aggregate clone count across all clones (within
    the same group, if applicable) that share the receptor sequence in that row.</p></dd>


    <dt>AggregatedCloneFrequency</dt>
<dd><p>The aggregate clone frequency across all clones
    (within the same group, if applicable) that share the receptor sequence in that row.</p></dd>


    <dt>UniqueCloneCount</dt>
<dd><p>The number of clones (rows) in <code>data</code> (within the
    same group, if applicable) possessing the receptor sequence for the current row.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Hai Yang, Jason Cham, Brian Neal, Zenghua Fan, Tao He and Li Zhang. (2023).
NAIR: Network Analysis of Immune Repertoire. <em>Frontiers in Immunology</em>, vol. 14.
<a href="https://www.frontiersin.org/articles/10.3389/fimmu.2023.1181825/full" class="external-link">doi: 10.3389/fimmu.2023.1181825</a></p>
<p><a href="https://mlizhangx.github.io/Network-Analysis-for-Repertoire-Sequencing-/index.html">Webpage for the NAIR package</a></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Brian Neal (<a href="mailto:Brian.Neal@ucsf.edu">Brian.Neal@ucsf.edu</a>)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  clone_seq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ATCG"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"ACAC"</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"GGGG"</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  clone_count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">7</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  clone_freq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">7</span>, <span class="fl">7</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  time_point <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"t_0"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"t_0"</span>, <span class="st">"t_1"</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  subject_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">my_data</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   clone_seq clone_count clone_freq time_point subject_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      ATCG           1  0.1428571        t_0          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      ACAC           1  0.1428571        t_0          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      ACAC           1  0.1428571        t_1          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      GGGG           1  0.1428571        t_0          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      GGGG           1  0.1428571        t_1          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      GGGG           1  0.1428571        t_0          2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      GGGG           1  0.1428571        t_1          2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">aggregateIdenticalClones</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">my_data</span>,</span></span>
<span class="r-in"><span>  <span class="st">"clone_seq"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"clone_count"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"clone_freq"</span>,</span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   clone_seq AggregatedCloneCount AggregatedCloneFrequency UniqueCloneCount</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      ACAC                    2                0.2857143                1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      ATCG                    1                0.1428571                1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      GGGG                    4                0.5714286                1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># group clones by time point</span></span></span>
<span class="r-in"><span><span class="fu">aggregateIdenticalClones</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">my_data</span>,</span></span>
<span class="r-in"><span>  <span class="st">"clone_seq"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"clone_count"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"clone_freq"</span>,</span></span>
<span class="r-in"><span>  grouping_cols <span class="op">=</span> <span class="st">"time_point"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   clone_seq time_point AggregatedCloneCount AggregatedCloneFrequency</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      ACAC        t_0                    1                0.1428571</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      ACAC        t_1                    1                0.1428571</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      ATCG        t_0                    1                0.1428571</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      GGGG        t_0                    2                0.2857143</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      GGGG        t_1                    2                0.2857143</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   UniqueCloneCount</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4                1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5                1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># group clones by subject ID</span></span></span>
<span class="r-in"><span><span class="fu">aggregateIdenticalClones</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">my_data</span>,</span></span>
<span class="r-in"><span>  <span class="st">"clone_seq"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"clone_count"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"clone_freq"</span>,</span></span>
<span class="r-in"><span>  grouping_cols <span class="op">=</span> <span class="st">"subject_id"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   clone_seq subject_id AggregatedCloneCount AggregatedCloneFrequency</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      ACAC          1                    2                0.2857143</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      ATCG          1                    1                0.1428571</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      GGGG          1                    2                0.2857143</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      GGGG          2                    2                0.2857143</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   UniqueCloneCount</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4                1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># group clones by time point and subject ID</span></span></span>
<span class="r-in"><span><span class="fu">aggregateIdenticalClones</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">my_data</span>,</span></span>
<span class="r-in"><span>  <span class="st">"clone_seq"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"clone_count"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"clone_freq"</span>,</span></span>
<span class="r-in"><span>  grouping_cols <span class="op">=</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"subject_id"</span>, <span class="st">"time_point"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   clone_seq subject_id time_point AggregatedCloneCount AggregatedCloneFrequency</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      ACAC          1        t_0                    1                0.1428571</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      ACAC          1        t_1                    1                0.1428571</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      ATCG          1        t_0                    1                0.1428571</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      GGGG          1        t_0                    1                0.1428571</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      GGGG          1        t_1                    1                0.1428571</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      GGGG          2        t_0                    1                0.1428571</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      GGGG          2        t_1                    1                0.1428571</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   UniqueCloneCount</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4                1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5                1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6                1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7                1</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Brian Neal, Hai Yang, Daniil Matveev, Phi Long Le, Li Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

